<!DOCTYPE html>
<html lang="es" class="no-js">
  <head>
    
    
    
    

    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Transformaciones afines en OpenGL con Python">
      
      
        <link rel="canonical" href="https://docs.hektorprofe.net/opengl/06-transformaciones-afines/">
      
      
        <meta name="author" content="Héctor Costa Guzman">
      
      <link rel="shortcut icon" href="/favicon.ico">
    
    
      
        <title>Transformaciones afines | OpenGL en Python | Hektor Profe</title>
      
    
    <link rel="stylesheet" href="../../assets/stylesheets/application.2.css">
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    
    <link rel="stylesheet" href="/assets/stylesheets/tingle.min.css">
<style>
@font-face{font-family:"Material Icons";font-style:normal;font-weight:400;src:local("Material Icons"),local("MaterialIcons-Regular"),url("/assets/fonts/specimen/MaterialIcons-Regular.woff2") format("woff2"),url("/assets/fonts/specimen/MaterialIcons-Regular.woff") format("woff"),url("/assets/fonts/specimen/MaterialIcons-Regular.ttf") format("truetype")}
[data-md-color-primary="grey"] .md-header { background-color: #191A1D }
[data-md-color-primary="grey"] .md-tabs { background-color: #222831 }
.md-footer-nav { background-color: #222831; }
.md-footer-meta { background-color: #191A1D }
html [data-md-color-primary="grey"] .md-nav--primary .md-nav__title--site { background-color: #191A1D; }
.mini{ display: none; } .maxi{ display: block; }
.embed-container { position: relative; padding-bottom: 56.25%;height: 0; overflow: hidden; max-width: 100%; height: auto; margin-bottom: 0; } 
.embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
.md-nav__link:focus, .md-nav__link:hover { color: #018dc5; }
.headerlink{ color: #018dc5 !important; }
.md-footer-links__highlight a{ color: #777 !important; }
.md-footer-links__highlight a:hover{ color: #ddd !important; }
.visible{ display: inherit !important; }
/*.md-tabs { display: none !important; }*/
.nav__btn, .nav__logo{ transition: 0.3s; }
.nav__btn:hover{ color: #aaa; }
.nav__logo:hover{ opacity:.7; }
.nav__logo {max-width: 225px !important; }
img:not([src]){visibility:hidden;}
img.click{opacity: 0.96;box-shadow:rgb(79, 82, 92) -4px 4px}
img.click:hover{opacity: 1;box-shadow:rgb(10, 172, 237) -4px 4px}
.button { background-color: #36bf2d; border: none; color: white !important; padding: 20px 0px; text-align: center; text-decoration: none; display: block; font-size: 97%; width: 100%; font-weight: bold;}
.button:hover { background-color: #4CAF50; color: white; }
.animated.delay-1dot5s {animation-delay: 1.5s;}
.md-icon--search { display:inline-block!important}
a.headerlink{ display: none !important; }
small.edited { display: block; text-align: right; }
#cookie-bar { padding: 1.8rem 1.25rem !important; background: #191A1D  !important; box-shadow:rgba(0, 0, 0, 0.2) 4px 4px 8px 8px; }
#cookie-bar-prompt-logo{ display: none !important; }
div.my-img{text-align:center;margin-top:20px}
@media (max-width: 76.1875em){ .mini{ display: block; } .maxi{ display: none;} /*.md-nav__link[for="nav-1"] { display: none; }*/ }
@media (min-width: 1599.9px){ .md-header-nav__button.md-logo img { height: 37.5px !important; width: 220px; } }
@media (min-width: 1999.9px){ .md-header-nav__button.md-logo img { height: 40px !important; width: 240px; } }
/* Rectificación footer en paginas pequeñas de altura */
@media (max-width: 1599.8px){ .md-container {height: calc(100% - 48px)} }
@media (min-width: 1599.9px){ .md-container {height: calc(100% - 53px)} }
@media (min-width: 1999.9px){ .md-container {height: calc(100% - 58px)} }
@media only screen and (max-width: 959.9px) { .nav__logo { display: block !important; }} 
@media only screen and (min-width: 960px) and (max-width: 76.1875em) { .nav__logo { display: block !important; }} 
@media only screen and (min-width: 76.1875em) { .nav__logo { display: none !important; } } 
@media only screen and (max-width: 76.1875em) { .md-sidebar--primary { left: -26.2rem;; width: 26.2rem; }  [data-md-toggle="drawer"]:checked ~ .md-container .md-sidebar--primary { -webkit-transform: translateX(26.2rem); transform: translateX(26.2rem); } [dir="rtl"] [data-md-toggle="drawer"]:checked ~ .md-container .md-sidebar--primary { -webkit-transform: translateX(-26.2rem); transform: translateX(-26.2rem); } }
@media (min-width: 1219.9px){ #home__btn { display: none !important; } #cursos__btn{ color: white !important; } [data-md-color-primary="grey"] .md-nav__link--active{ color: rgba(0, 0, 0, 0.87); text-decoration: underline !important; } }
@media (min-width: 467.9px){ #discord__btn{ display: inline-block !important; } }
@media only screen and (min-width: 60em){ .md-search__input { background-color: rgb(53, 54, 56); } .md-search__input:hover { background-color: rgb(84, 87, 93); color: white; }}
@media (max-width: 1219.9px){ .md-header-nav__title{ padding: 0 1rem; } .nav__btn {display:none;} }
@media (max-width: 875.9px){ #cookie-bar-button{ margin-top: 20px !important; }}
@media (max-width: 719.9px){ #cookie-bar { padding: 3.25rem 1.25rem; }}
@media (max-width: 512.9px){ #cookie-bar { padding: 2rem 1.25rem; }}

.tingle-modal { font-size:18px !important;}
.tingle-modal-box{ width: 80%; max-width: 1100px; }
.tingle-btn--danger{ background: darkorange !important; }
.tingle-modal-box__content { padding: 3rem 2rem 3rem 3rem;}
@media (max-width: 540px){ .tingle-modal-box{ width: auto; } }
@media (max-width: 849px){ #supermodal{ grid-template-columns:100% !important; }}

.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 275px - 60px)}
@media (max-width: 1999.9px){.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 246px - 60px);margin-right:-1px;}}
@media (max-width: 1599.9px){.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 222px - 60px)}}

</style>
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="grey" data-md-color-accent="grey">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#transformaciones-afines-con-opengl" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header
  class="md-header"
  data-md-component="header"
  style="position: inherit !important"
>
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a
          href="/"
          title="Hektor Profe"
          class="md-header-nav__button md-logo"
          style="font-size: 0px"
        >
          <img
            src="/assets/images/logo.png"
            width="200px"
            height="35px"
            style="margin-top: -5px"
            alt="Hektor Profe"
            title="Hektor Profe"
          />
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label
          class="md-icon md-icon--menu md-header-nav__button"
          for="__drawer"
        ></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div
          class="md-flex__ellipsis md-header-nav__title"
          data-md-component="title"
          style="text-align: right"
        >
          <!-- https://fontawesome.com/v4.7.0/ -->
          <a 
            class="nav__btn" 
            href="https://www.hektorprofe.net/" 
            style="margin-left:0em;" 
            title="Cursos de Hektor Profe">
            Cursos
          </a>
          <a 
            class="nav__btn" 
            href="https://docs.hektorprofe.net/" 
            style="margin-left:1.4em;" 
            title="Documentos de Hektor Profe">
            Documentos
          </a>
          <a 
            class="nav__btn" 
            href="https://www.hektorprofe.net/portafolio/" 
            style="margin-left:1.4em;" 
            title="Portafolio de Hektor Profe">
            Portafolio
          </a>
          <a href="/"
            ><img
              class="nav__logo"
              src="/assets/images/logo.png"
              width="200px"
              height="35px"
              style="margin: 6px auto 0"
              alt="Hektor Profe"
              title="Hektor Profe"
          /></a>
        </div>
        <style>
          .md-sidebar[data-md-state="lock"] {
            top: 0rem !important;
          }
          .md-tabs {
            display: none !important;
          }
          .hde {
            display: inline-block;
          }
          .admonition.note > .superfences-tabs > label:hover,
          .headerlink {
            color: #018dc5 !important;
          }
          .admonition.info {
            font-size: 100%;
          }
          .admonition.info label {
            font-size: 91%;
          }
          .admonition.note > .admonition-title {
            display: none;
          }
          .image {
            text-align: center;
            margin-top: 25px;
          }
          .contenedor_youtube {
            position: relative !important;
            padding-bottom: 56.25% !important; /*panorámico*/
            padding-top: 0px !important;
            height: 0 !important;
            margin-top: -20px;
            margin-bottom: 25px;
          }
          .contenedor_youtube iframe {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
          }
        </style>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container" style="padding-top: 0px !important;">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list" id="top__tabs">
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
      </ul>
    </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container" style="padding-top: 8px !important;">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap" id="md__sidebar__scroll">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title" for="__drawer" style="padding:0 !important;max-height:5.5rem;"></label>
  
  <ul class="md-nav__list" id="main__list" data-md-scrollfix>
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
        <!-- comprobación extra -->
         
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" checked>
    
    <label class="md-nav__link" for="nav-9">
      Apuntes de OpenGL
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Apuntes de OpenGL
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
            
            
            


  <li class="md-nav__item">
    <a href="../" title="Índice del archivo" class="md-nav__link">
      Índice del archivo
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../01-primeros-pasos/" title="Primeros pasos" class="md-nav__link">
      Primeros pasos
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../02-graficos-primitivos/" title="Gráficos primitivos" class="md-nav__link">
      Gráficos primitivos
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../03-programando-una-tortuga/" title="Tortuga y fractales" class="md-nav__link">
      Tortuga y fractales
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../04-trabajando-con-mallas/" title="Trabajando con mallas" class="md-nav__link">
      Trabajando con mallas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../05-dibujando-el-espacio-3d/" title="Dibujando el espacio 3D" class="md-nav__link">
      Dibujando el espacio 3D
    </a>
  </li>

        
            
            
            

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Transformaciones afines
      </label>
    
    <a href="./" title="Transformaciones afines" class="md-nav__link md-nav__link--active" id="md__active_link">
      Transformaciones afines
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#acerca-de-las-matrices" title="Acerca de las matrices" class="md-nav__link toc__link">
    Acerca de las matrices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrices-de-transformacion" title="Matrices de transformación" class="md-nav__link toc__link">
    Matrices de transformación
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traslacion-en-nuestra-malla" title="Traslación en nuestra malla" class="md-nav__link toc__link">
    Traslación en nuestra malla
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rotacion-en-nuestra-malla" title="Rotación en nuestra malla" class="md-nav__link toc__link">
    Rotación en nuestra malla
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#escalado-en-nuestra-malla" title="Escalado en nuestra malla" class="md-nav__link toc__link">
    Escalado en nuestra malla
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#propiedades-afines" title="Propiedades afines" class="md-nav__link toc__link">
    Propiedades afines
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proximos-pasos" title="Próximos pasos" class="md-nav__link toc__link">
    Próximos pasos
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
      
    
      
    
      
    
      
    
      
    
  </ul>
</nav>

                  </div>
                </div>
              </div>
            

            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                
                  
                    <div class="course-offer" style="margin-bottom:25px;padding:0px 10px;">
                      <a href="https://www.hektorprofe.net/cupon/python" target="_blank">
                        <img src="/cdn/assets/python.png" style="width:100%;justify-self:center;align-self:center;"/>
                      </a>
                    </div>
                  
                

                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#acerca-de-las-matrices" title="Acerca de las matrices" class="md-nav__link toc__link">
    Acerca de las matrices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrices-de-transformacion" title="Matrices de transformación" class="md-nav__link toc__link">
    Matrices de transformación
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traslacion-en-nuestra-malla" title="Traslación en nuestra malla" class="md-nav__link toc__link">
    Traslación en nuestra malla
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rotacion-en-nuestra-malla" title="Rotación en nuestra malla" class="md-nav__link toc__link">
    Rotación en nuestra malla
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#escalado-en-nuestra-malla" title="Escalado en nuestra malla" class="md-nav__link toc__link">
    Escalado en nuestra malla
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#propiedades-afines" title="Propiedades afines" class="md-nav__link toc__link">
    Propiedades afines
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proximos-pasos" title="Próximos pasos" class="md-nav__link toc__link">
    Próximos pasos
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="transformaciones-afines-con-opengl">Transformaciones afines con OpenGL<a class="headerlink" href="#transformaciones-afines-con-opengl" title="Permanent link">&para;</a></h1>
<p>En esta sección vamos a repasar las transformaciones afines mediante matrices y su funcionamiento en OpenGL:</p>
<ul>
<li><strong>Traslación</strong>: Movimiento del objeto a lo largo de los ejes:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">glTranslated</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="c1"># digit</span>
<span class="n">glTranslatef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="c1"># float</span>
</code></pre></div>
<ul>
<li><strong>Rotación</strong>: Orientación del objeto respecto a los ejes. Alrededor del eje <code>Y</code> se denomina <code>yaw</code>, para el eje <code>X</code> se llama <code>pitch</code> y para el eje <code>Z</code> es <code>roll</code> y se especifica en grados:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">glRotated</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="c1"># digit</span>
<span class="n">glRotatef</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="c1"># float</span>
</code></pre></div>
<ul>
<li><strong>Escalado</strong>: Redimensión del objeto respecto a los ejes:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">glScaled</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="c1"># digit</span>
<span class="n">glScalef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="c1"># float</span>
</code></pre></div>
<ul>
<li><strong>Cizallamiento (<em>shearing</em>)</strong>: Movimiento parcial alrededor de una o más dimensiones.</li>
</ul>
<p><img alt="" src="/cdn/opengl/img51.png" /></p>
<p>No hay función como tal, la matriz de <em>shearing</em> es la siguiente:</p>
<p><img alt="" src="/cdn/opengl/img52.png" /></p>
<h2 id="acerca-de-las-matrices">Acerca de las matrices<a class="headerlink" href="#acerca-de-las-matrices" title="Permanent link">&para;</a></h2>
<p>Las matrices son un concepto fundamental en los gráficos por computadora y se utilizan en casi todos los cálculos que involucran mover y ubicar objetos.</p>
<p>Una matriz es un arreglo rectangular de números con una cantidad fija de filas y columnas:</p>
<p><img alt="" src="/cdn/opengl/img53.png" /></p>
<p>Una matriz con una fila se llama vector de fila y una matriz con una columna se llama vector de columna:</p>
<p><img alt="" src="/cdn/opengl/img54.png" /></p>
<p>Una matriz cuadrada, que es el tipo más común utilizado en los cálculos de juegos de computadora, es una con el mismo número de filas que columnas:</p>
<p><img alt="" src="/cdn/opengl/img55.png" /></p>
<p>Las matrices cuadradas que se usan con frecuencia son la matriz cero y la matriz de identidad.</p>
<p>Una matriz cero, como su nombre indica, es todo ceros, y una matriz identidad es todo ceros con unos en la diagonal:</p>
<p><img alt="" src="/cdn/opengl/img56.png" /></p>
<p>La matriz de identidad se considera la matriz neutra. De forma simular al número 1, multiplicar una matriz por la identidad da como resulta la misma matriz.</p>
<p>Todos los cálculos matemáticos comunes se pueden realizar en matrices.</p>
<p>El <strong>escalado</strong>, que denota una multiplicación o división, implica multiplicar cada valor de la matriz por un mismo número. Por ejemplo, en esta matriz de dos por dos se multiplica por cuatro la matriz resultante:</p>
<p><img alt="" src="/cdn/opengl/img57.png" /></p>
<p>La <strong>suma</strong> y la <strong>resta</strong> solo es posible entre los elementos de las mismas posiciones:</p>
<p><img alt="" src="/cdn/opengl/img58.png" /></p>
<p>Otro concepto que usamos cuando trabajamos con matrices es el de la matriz <strong>transpuesta</strong>.</p>
<p>La transposición de una matriz es cuando los valores de las filas se intercambian con los valores de las columnas:</p>
<p><img alt="" src="/cdn/opengl/img59.png" /></p>
<p>La <strong>multiplicación</strong> de matrices es el quid de muchas operaciones que ocurren en los gráficos y juegos de computadora.</p>
<p>Dos matrices solo se pueden multiplicar si se pueden formar. Eso significa que el número de columnas de la primera matriz debe ser igual al número de filas en la segunda matriz:</p>
<p><img alt="" src="/cdn/opengl/img60.png" /></p>
<p>Básicamente, tomamos cada fila de la primera matriz y encontramos el producto escalar de ella y las columnas de la segunda matriz.</p>
<p>La primera fila será:</p>
<p><img alt="" src="/cdn/opengl/img62.png" /></p>
<p>La segunda:</p>
<p><img alt="" src="/cdn/opengl/img63.png" /></p>
<p>Y la tercera:</p>
<p><img alt="" src="/cdn/opengl/img64.png" /></p>
<p>El resultado final, una matriz con el mismo número de filas que la primera y columnas que la segunda:</p>
<p><img alt="" src="/cdn/opengl/img60b.png" /></p>
<h2 id="matrices-de-transformacion">Matrices de transformación<a class="headerlink" href="#matrices-de-transformacion" title="Permanent link">&para;</a></h2>
<p>El quid de la cuestión es que las transformaciones se pueden traducir a matrices, de manera que al multiplicar las matrices de transformación entre ellas obtenemos una única matriz conocida como matriz de mundo.</p>
<p>En lugar de realizar los cálculos una y otra vez para cada vértice, la matriz de mundo contiene una combinación de todas las demás que dará como resultado el renderizado deseado para cada modelo.</p>
<p>La estructura de la <strong>matriz de escalado</strong> es la siguiente:</p>
<p><img alt="" src="/cdn/opengl/img65.png" /></p>
<p>Donde se substituye una matriz de identidad con los factores de escalado en cada componente <code>sx, sy, sz</code>. El resultado es equivalente a multiplicar el punto <code>x,y,z</code> por los factores:</p>
<p><img alt="" src="/cdn/opengl/img66.png" /></p>
<p>La estructura de la <strong>matriz de traslación</strong> es la siguiente:</p>
<p><img alt="" src="/cdn/opengl/img67.png" /></p>
<p>Se trata de una matriz especial, pues realmente lo que necesitamos es sumar la cantidad de traslación <code>tx, ty, tz</code> en cada eje.</p>
<p>La traslación no es una transformación lineal, sino que utiliza una cuarta columna para almacenar las distancias de traslación y sumarlas al punto original <code>x,y,z</code>.</p>
<p>Esta es la razón principal por la que se utiliza una matriz <code>4x4</code> y no <code>3x3</code> también en las demás transformaciones, en caso contrario no podríamos multiplicarlas entre ellas:</p>
<p><img alt="" src="/cdn/opengl/img68.png" /></p>
<p>Finalmente la estructura de la <strong>matriz de rotación</strong> es algo más elaborada, principalmente porque tenemos tres de ellas, una para controlar la rotación en cada eje (<code>yaw, pitch, roll</code>) que podemos conseguir <a href="https://docs.hektorprofe.net/graficos-3d/05-transformaciones-lineales/#rotacion-de-vectores">aplicando trigonometría</a>:</p>
<p><img alt="" src="/cdn/opengl/img47.png" /></p>
<p>Al congelar el eje <code>X</code> la matriz de rotación para el ángulo <code>pitch</code> es:</p>
<p><img alt="" src="/cdn/opengl/img70.png" /></p>
<p>Al congelar el eje <code>Y</code> la matriz de rotación para el ángulo <code>yaw</code> es:</p>
<p><img alt="" src="/cdn/opengl/img71.png" /></p>
<p>Al congelar el eje <code>Z</code> la matriz de rotación para el ángulo <code>roll</code> es:</p>
<p><img alt="" src="/cdn/opengl/img69.png" /></p>
<p>Al multiplicar las tres matrices de rotación entre ellas se consigue la <strong>matriz de rotación</strong>.</p>
<p>En OpenGL la <strong>matriz de mundo</strong> es la matriz resultante de multiplicar las tres matrices de transformación por este orden (tal como expliqué anteriormente):</p>
<ol>
<li>Traslación</li>
<li>Rotación</li>
<li>Escalado</li>
</ol>
<p>Por suerte no tenemos que multiplicar las matrices a mano, solo tenemos que configurar la cantidad de traslación, rotación y escalado en cada eje y dejar que OpenGL se encargue de realizar los cálculos.</p>
<h2 id="traslacion-en-nuestra-malla">Traslación en nuestra malla<a class="headerlink" href="#traslacion-en-nuestra-malla" title="Permanent link">&para;</a></h2>
<p>Durante las próximas tres prácticas vamos a incorporar las transformaciones afines a nuestra clase <code>Mesh</code>, empezando por la traslación.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pygame</span> <span class="k">as</span> <span class="nn">pg</span>

<span class="k">class</span> <span class="nc">Mesh</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objPath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span><span class="o">...</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span>

    <span class="k">def</span> <span class="nf">Draw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">glPushMatrix</span><span class="p">()</span>
        <span class="n">glTranslatef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">triangles</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span>
            <span class="n">glBegin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drawtype</span><span class="p">)</span>
            <span class="n">glVertex3fv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="n">glVertex3fv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]])</span>
            <span class="n">glVertex3fv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]])</span>
            <span class="n">glEnd</span><span class="p">()</span>
        <span class="n">glPopMatrix</span><span class="p">()</span>
</code></pre></div>
<p>Podemos configurarle la posición inicial:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">OpenGLApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">Init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Setup the mesh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;../res/models/cube.obj&quot;</span><span class="p">,</span> <span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img72.png" /></p>
<p>Podríamos dibujar varios cubos uno sobre otro:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">OpenGLApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">Init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Setup the meshes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meshes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;../res/models/cube.obj&quot;</span><span class="p">,</span> <span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)),</span>
            <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;../res/models/cube.obj&quot;</span><span class="p">,</span> <span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)),</span>
            <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;../res/models/cube.obj&quot;</span><span class="p">,</span> <span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))]</span>

    <span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span> <span class="o">|</span> <span class="n">GL_DEPTH_BUFFER_BIT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawWorldAxes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UpdateCamera</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">mesh</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meshes</span><span class="p">:</span>
            <span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img73.png" /></p>
<p>En este punto estamos creando tres objetos independientes uno encima del otro, sin embargo, ya que son el mismo objeto, sería más práctico y óptimo si trasladamos un único cubo y lo dibujamos en tres lugares distintos.</p>
<p>Lo que haremos es enviar al propio método <code>Draw</code> una posición de movimiento relativo donde queramos dibujar el objeto:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
    <span class="n">glPushMatrix</span><span class="p">()</span>
    <span class="n">glTranslatef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="n">glTranslatef</span><span class="p">(</span><span class="n">move</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">move</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">move</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>  <span class="c1"># Movimiento relativo</span>
</code></pre></div>
<p>Ahora simplemente con un cubo podemos reposicionarlo de forma relativa antes de dibujarlo tres veces:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">OpenGLApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">Init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Setup the mesh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;../res/models/cube.obj&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span> <span class="o">|</span> <span class="n">GL_DEPTH_BUFFER_BIT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawWorldAxes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UpdateCamera</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
</code></pre></div>
<p>Esto es mucho más óptimo, pues se trata del mismo objeto dibujado en diferentes lugares, ocupando en la memoria un solo objeto.</p>
<p>Nada nos impediría utilizar un bucle y dibujar el cubo en forma de tabla <code>5x5</code> creando una pared:</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span> <span class="o">|</span> <span class="n">GL_DEPTH_BUFFER_BIT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawWorldAxes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UpdateCamera</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img74.png" /></p>
<h2 id="rotacion-en-nuestra-malla">Rotación en nuestra malla<a class="headerlink" href="#rotacion-en-nuestra-malla" title="Permanent link">&para;</a></h2>
<p>A continuación vamos a hacer lo mismo que con la traslación pero implementando la rotación en la clase.</p>
<p>Recordemos que la rotación debe realizarse después de la traslación y antes del escalado, además toma el ángulo y los componentes donde aplicar la rotación, por eso es buena idea crear una clase <code>Rotation</code> con el ángulo y los componentes:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Rotation</span><span class="p">:</span>
    <span class="c1"># Establecemos el ángulo y rotación por defecto a cero</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>

<span class="k">class</span> <span class="nc">Mesh</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objPath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">Rotation</span><span class="p">(),</span> <span class="o">...</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span>

    <span class="k">def</span> <span class="nf">Draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rotate</span><span class="o">=</span><span class="n">Rotation</span><span class="p">()):</span>
        <span class="n">glPushMatrix</span><span class="p">()</span>
        <span class="c1"># Procesamos la posición inicial</span>
        <span class="n">glTranslatef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="c1"># Sumamos el movimiento relativa</span>
        <span class="n">glTranslatef</span><span class="p">(</span><span class="n">move</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">move</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">move</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="c1"># Realizamos la rotación inicial</span>
        <span class="n">glRotatef</span><span class="p">(</span><span class="n">rotate</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="c1"># Sumamos la rotación relativa</span>
        <span class="n">glRotatef</span><span class="p">(</span><span class="n">rotate</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="n">rotate</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
                  <span class="n">rotate</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">rotate</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</code></pre></div>
<p>Podemos establecerlo:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">OpenGLApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">Init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Setup the meshes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;../res/models/cube.obj&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span> <span class="o">|</span> <span class="n">GL_DEPTH_BUFFER_BIT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawWorldAxes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UpdateCamera</span><span class="p">()</span>
        <span class="c1"># Dibujamos el modelo con traslación y rotación relativa</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Rotation</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img75.png" /></p>
<h2 id="escalado-en-nuestra-malla">Escalado en nuestra malla<a class="headerlink" href="#escalado-en-nuestra-malla" title="Permanent link">&para;</a></h2>
<p>Por último vamos a añadir el escalado a la clase, como siempre tanto de forma inicial como relativa, después de la rotación:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Mesh</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objPath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">Rotation</span><span class="p">(),</span> <span class="n">scaling</span><span class="o">=</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">...</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaling</span> <span class="o">=</span> <span class="n">scaling</span>

    <span class="k">def</span> <span class="nf">Draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rotate</span><span class="o">=</span><span class="n">Rotation</span><span class="p">(),</span> <span class="n">scale</span><span class="o">=</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>
        <span class="n">glPushMatrix</span><span class="p">()</span>
        <span class="c1"># Procesamos la posición inicial</span>
        <span class="n">glTranslatef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="c1"># Sumamos el movimiento relativa</span>
        <span class="n">glTranslatef</span><span class="p">(</span><span class="n">move</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">move</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">move</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="c1"># Realizamos la rotación inicial</span>
        <span class="n">glRotatef</span><span class="p">(</span><span class="n">rotate</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="c1"># Sumamos la rotación relativa</span>
        <span class="n">glRotatef</span><span class="p">(</span><span class="n">rotate</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="n">rotate</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
                  <span class="n">rotate</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">rotate</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="c1"># Realizamos el escalado inicial</span>
        <span class="n">glScalef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scaling</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaling</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaling</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="c1"># Realizamos el escalado relativo</span>
        <span class="n">glScalef</span><span class="p">(</span><span class="n">scale</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">scale</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</code></pre></div>
<p>Podemos probar si funciona triplicando el tamaño del cubo ya posicionado y rotado.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span> <span class="o">|</span> <span class="n">GL_DEPTH_BUFFER_BIT</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">DrawWorldAxes</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">UpdateCamera</span><span class="p">()</span>
    <span class="c1"># Dibujamos el modelo con traslación, rotación y escalado relativo</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">Rotation</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                    <span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img76.png" /></p>
<p>Evidentemente el escalado se realiza respecto al centro del modelo.</p>
<h2 id="propiedades-afines">Propiedades afines<a class="headerlink" href="#propiedades-afines" title="Permanent link">&para;</a></h2>
<p>Finalmente comentemos algunas propiedades de estas transformaciones:</p>
<ul>
<li>Las líneas se mantienen rectas, los planos se mantienen planos.</li>
<li>Tanto las líneas como los planos mantienen su paralelisimo.</li>
<li>Las columnas de la matriz de transformación revelan el sistema de coordenadas.</li>
<li>Las proporciones de la transformación de escalado se mantienen relativas.</li>
</ul>
<h2 id="proximos-pasos">Próximos pasos<a class="headerlink" href="#proximos-pasos" title="Permanent link">&para;</a></h2>
<p>A partir de este punto la idea es adaptar el código para utilizar shaders, esto nos permitirá entre otras cosas almacenar los vértices en la memoria de la gráfica para ahorrarle a la CPU todo su manejo en cada iteración del bucle, lo cuál aumentará exponencialmente el rendimiento de renderizado y por tanto la cantidad de modelos que podemos dibujar a la vez, pero eso es una historia para otro día...</p>
<p><small class="edited"><i>Última edición: 3 de Octubre de 2022</i></small></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-nav">
    <nav class="md-footer-nav__inner md-grid">
      
      <a
        href="../05-dibujando-el-espacio-3d/"
        title="Dibujando el espacio 3D"
        class="md-flex md-footer-nav__link md-footer-nav__link--prev"
        rel="prev"
      >
        <div class="md-flex__cell md-flex__cell--shrink">
          <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
        </div>
        <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
          <span class="md-flex__ellipsis">
            <span class="md-footer-nav__direction">
              Anterior
            </span>
            Dibujando el espacio 3D
          </span>
        </div>
      </a>
       
      <a
        href="../../unity/"
        title="Índice del archivo"
        class="md-flex md-footer-nav__link md-footer-nav__link--next"
        rel="next"
      >
        <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
          <span class="md-flex__ellipsis">
            <span class="md-footer-nav__direction">
              Siguiente
            </span>
            Índice del archivo
          </span>
        </div>
        <div class="md-flex__cell md-flex__cell--shrink">
          <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
        </div>
      </a>
      
    </nav>
  </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        <!--<div class="md-footer-links__highlight">
          <a href="/comunidad/">Comunidad</a> · <a href="/politica-de-cookies/">Política de cookies</a> · <a href="/sobre-mi/">Sobre mí</a>
        </div>-->
        <div class="md-footer-copyright__highlight">
          2015 - 2022 &copy; Héctor Costa Guzmán (<u
            ><a
              href="https://creativecommons.org/licenses/by/4.0/deed.es"
              target="_blank"
              rel="nofollow"
              >Licencia CC BY 4.0</a
            ></u
          >)
        </div>
      </div>
       
<style>.md-footer-social__link {transition: 0.3s;}</style>
<div class="md-footer-social" style="font-size: 2.5rem; margin-top: -6px!important; padding: 0px!important; margin-bottom: -6px; overflow: hidden!important;">
  <a href="https://github.com/hcosta" title="Github" target="_blank" class="md-footer-social__link fa fa-github-square"></a>
  <a href="https://www.youtube.com/c/HektorProfe" title="Youtube" target="_blank" class="md-footer-social__link fa fa-youtube-square"></a>
  &nbsp;
</div>
 
    </div>
  </div>
  <script>
    (function (i, s, o, g, r, a, m) {
      i["GoogleAnalyticsObject"] = r;
      (i[r] =
        i[r] ||
        function () {
          (i[r].q = i[r].q || []).push(arguments);
        }),
        (i[r].l = 1 * new Date());
      (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m);
    })(
      window,
      document,
      "script",
      "https://www.google-analytics.com/analytics.js",
      "ga"
    );
    ga("create", "UA-124845547-1", "auto");
    ga("send", "pageview");
  </script>
</footer>
      
      <a id="anchorID" href="https://www.hektorprofe.net/" target="_blank"></a>
    </div>
  <script type='text/javascript' src="/assets/javascripts/application.a26c1c21.js"></script>
  <script src="/assets/javascripts/tingle.min.js"></script>
  <script type='text/javascript'>
    var modalButtonOnly = new tingle.modal({
        closeMethods: [],
        footer: true,
        stickyFooter: true
    });
    var btn5 = document.querySelector('.js-tingle-modal-5');

    // set content
    modalButtonOnly.setContent(`
    <div style="display:grid;grid-template-columns:32% 32% 32%;grid-column-gap: 1.33%;" id="supermodal">
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/python" target="_blank"><img src="/cdn/assets/python.png" style="width:100%;justify-self:center;align-self:center;"/></a>
      </div>
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/django" target="_blank"><img src="/cdn/assets/django.png" style="width:100%;justify-self:center;align-self:center;"/></a>
      </div>
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/pyside" target="_blank"><img src="/cdn/assets/pyside.png" style="width:100%;justify-self:center;align-self:center;"/></a>
      </div>
    </div>`);

    modalButtonOnly.addFooterBtn('Cerrar', 'tingle-btn tingle-btn--default tingle-btn--pull-right', function(){
      modalButtonOnly.close();
    });

    app.initialize({version:"1.2.3",url:{base:"../.."}})
    var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.LazyLoad=e()}(this,function(){"use strict";function t(t,e,n){var o=e._settings;!n&&i(t)||(C(o.callback_enter,t),R.indexOf(t.tagName)>-1&&(N(t,e),I(t,o.class_loading)),E(t,e),a(t),C(o.callback_set,t))}var e={elements_selector:"img",container:document,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",class_loading:"loading",class_loaded:"loaded",class_error:"error",load_delay:0,callback_load:null,callback_error:null,callback_set:null,callback_enter:null,callback_finish:null,to_webp:!1},n=function(t){return _extends({},e,t)},o=function(t,e){return t.getAttribute("data-"+e)},r=function(t,e,n){var o="data-"+e;null!==n?t.setAttribute(o,n):t.removeAttribute(o)},a=function(t){return r(t,"was-processed","true")},i=function(t){return"true"===o(t,"was-processed")},s=function(t,e){return r(t,"ll-timeout",e)},c=function(t){return o(t,"ll-timeout")},l=function(t){return t.filter(function(t){return!i(t)})},u=function(t,e){return t.filter(function(t){return t!==e})},d=function(t,e){var n,o=new t(e);try{n=new CustomEvent("LazyLoad::Initialized",{detail:{instance:o}})}catch(t){(n=document.createEvent("CustomEvent")).initCustomEvent("LazyLoad::Initialized",!1,!1,{instance:o})}window.dispatchEvent(n)},f=function(t,e){return e?t.replace(/\.(jpe?g|png)/gi,".webp"):t},_="undefined"!=typeof window,v=_&&!("onscroll"in window)||/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),g=_&&"IntersectionObserver"in window,h=_&&"classList"in document.createElement("p"),b=_&&function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}(),m=function(t,e,n,r){for(var a,i=0;a=t.children[i];i+=1)if("SOURCE"===a.tagName){var s=o(a,n);p(a,e,s,r)}},p=function(t,e,n,o){n&&t.setAttribute(e,f(n,o))},y=function(t,e){var n=b&&e.to_webp,r=o(t,e.data_src),a=o(t,e.data_bg);if(r){var i=f(r,n);t.style.backgroundImage='url("'+i+'")'}if(a){var s=f(a,n);t.style.backgroundImage=s}},w={IMG:function(t,e){var n=b&&e.to_webp,r=e.data_srcset,a=t.parentNode;a&&"PICTURE"===a.tagName&&m(a,"srcset",r,n);var i=o(t,e.data_sizes);p(t,"sizes",i);var s=o(t,r);p(t,"srcset",s,n);var c=o(t,e.data_src);p(t,"src",c,n)},IFRAME:function(t,e){var n=o(t,e.data_src);p(t,"src",n)},VIDEO:function(t,e){var n=e.data_src,r=o(t,n);m(t,"src",n),p(t,"src",r),t.load()}},E=function(t,e){var n=e._settings,o=t.tagName,r=w[o];if(r)return r(t,n),e._updateLoadingCount(1),void(e._elements=u(e._elements,t));y(t,n)},I=function(t,e){h?t.classList.add(e):t.className+=(t.className?" ":"")+e},L=function(t,e){h?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")},C=function(t,e){t&&t(e)},O=function(t,e,n){t.addEventListener(e,n)},k=function(t,e,n){t.removeEventListener(e,n)},x=function(t,e,n){O(t,"load",e),O(t,"loadeddata",e),O(t,"error",n)},A=function(t,e,n){k(t,"load",e),k(t,"loadeddata",e),k(t,"error",n)},z=function(t,e,n){var o=n._settings,r=e?o.class_loaded:o.class_error,a=e?o.callback_load:o.callback_error,i=t.target;L(i,o.class_loading),I(i,r),C(a,i),n._updateLoadingCount(-1)},N=function(t,e){var n=function n(r){z(r,!0,e),A(t,n,o)},o=function o(r){z(r,!1,e),A(t,n,o)};x(t,n,o)},R=["IMG","IFRAME","VIDEO"],S=function(e,n,o){t(e,o),n.unobserve(e)},M=function(t){var e=c(t);e&&(clearTimeout(e),s(t,null))},j=function(t,e,n){var o=n._settings.load_delay,r=c(t);r||(r=setTimeout(function(){S(t,e,n),M(t)},o),s(t,r))},D=function(t){return t.isIntersecting||t.intersectionRatio>0},T=function(t){return{root:t.container===document?null:t.container,rootMargin:t.thresholds||t.threshold+"px"}},U=function(t,e){this._settings=n(t),this._setObserver(),this._loadingCount=0,this.update(e)};return U.prototype={_manageIntersection:function(t){var e=this._observer,n=this._settings.load_delay,o=t.target;n?D(t)?j(o,e,this):M(o):D(t)&&S(o,e,this)},_onIntersection:function(t){t.forEach(this._manageIntersection.bind(this))},_setObserver:function(){g&&(this._observer=new IntersectionObserver(this._onIntersection.bind(this),T(this._settings)))},_updateLoadingCount:function(t){this._loadingCount+=t,0===this._elements.length&&0===this._loadingCount&&C(this._settings.callback_finish)},update:function(t){var e=this,n=this._settings,o=t||n.container.querySelectorAll(n.elements_selector);this._elements=l(Array.prototype.slice.call(o)),!v&&this._observer?this._elements.forEach(function(t){e._observer.observe(t)}):this.loadAll()},destroy:function(){var t=this;this._observer&&(this._elements.forEach(function(e){t._observer.unobserve(e)}),this._observer=null),this._elements=null,this._settings=null},load:function(e,n){t(e,this,n)},loadAll:function(){var t=this;this._elements.forEach(function(e){t.load(e)})}},_&&function(t,e){if(e)if(e.length)for(var n,o=0;n=e[o];o+=1)d(t,n);else d(t,e)}(U,window.lazyLoadOptions),U});
    var myLazyLoad = new LazyLoad({elements_selector: ".lazy"});
    const mdMenuItems = document.querySelectorAll('.md-nav__link');
    function doNav(){ document.getElementById("main__list").innerHTML = '<li class="md-nav__item"><a class="md-nav__link" href="/cursos/">Cursos</a></li><li class="md-nav__item"><a class="md-nav__link" href="/blog/">Blog</a></li>';}
    for (i = 0; i < mdMenuItems.length; i++) {  var item = mdMenuItems[i]; var htmlstring = item.innerHTML; htmlstring = (htmlstring.trim) ? htmlstring.trim() : htmlstring.replace(/^\s+/,''); if (htmlstring == 'Servidor de encuentro') { item.parentNode.removeChild(item);continue; }  if (htmlstring == 'Política de Cookies') { item.parentNode.removeChild(item);continue; } if (htmlstring == 'Buscador') { item.parentNode.removeChild(item); continue; } }
    try { var topPos = document.querySelector('#md__active_link').offsetTop; document.querySelector('#md__sidebar__scroll').scrollTop = topPos - 60; } catch (err) {}
  </script>
  </body>
</html>