<!DOCTYPE html>
<html lang="es" class="no-js">
  <head>
    
    
    
    

    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Vamos a crear un proyecto utilizando los conceptos básicos: variables, colecciones, condiciones, bucles, funciones y módulos.">
      
      
        <link rel="canonical" href="https://docs.hektorprofe.net/academia/python/proyecto-gestor-clientes/">
      
      
        <meta name="author" content="Héctor Costa Guzman">
      
      <link rel="shortcut icon" href="/favicon.ico">
    
    
      
        <title>Proyecto gestor de clientes | Python | Academia | Hektor Profe</title>
      
    
    <link rel="stylesheet" href="../../../assets/stylesheets/application.2.css">
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    
    <link rel="stylesheet" href="/assets/stylesheets/tingle.min.css">
<style>
@font-face{font-family:"Material Icons";font-style:normal;font-weight:400;src:local("Material Icons"),local("MaterialIcons-Regular"),url("/assets/fonts/specimen/MaterialIcons-Regular.woff2") format("woff2"),url("/assets/fonts/specimen/MaterialIcons-Regular.woff") format("woff"),url("/assets/fonts/specimen/MaterialIcons-Regular.ttf") format("truetype")}
[data-md-color-primary="grey"] .md-header { background-color: #191A1D }
[data-md-color-primary="grey"] .md-tabs { background-color: #222831 }
.md-footer-nav { background-color: #222831; }
.md-footer-meta { background-color: #191A1D }
html [data-md-color-primary="grey"] .md-nav--primary .md-nav__title--site { background-color: #191A1D; }
.mini{ display: none; } .maxi{ display: block; }
.embed-container { position: relative; padding-bottom: 56.25%;height: 0; overflow: hidden; max-width: 100%; height: auto; margin-bottom: 0; } 
.embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
.md-nav__link:focus, .md-nav__link:hover { color: #018dc5; }
.headerlink{ color: #018dc5 !important; }
.md-footer-links__highlight a{ color: #777 !important; }
.md-footer-links__highlight a:hover{ color: #ddd !important; }
.visible{ display: inherit !important; }
/*.md-tabs { display: none !important; }*/
.nav__btn, .nav__logo{ transition: 0.3s; }
.nav__btn:hover{ color: #aaa; }
.nav__logo:hover{ opacity:.7; }
.nav__logo {max-width: 225px !important; }
img:not([src]){visibility:hidden;}
img.click{opacity: 0.96;box-shadow:rgb(79, 82, 92) -4px 4px}
img.click:hover{opacity: 1;box-shadow:rgb(10, 172, 237) -4px 4px}
.button { background-color: #36bf2d; border: none; color: white !important; padding: 20px 0px; text-align: center; text-decoration: none; display: block; font-size: 97%; width: 100%; font-weight: bold;}
.button:hover { background-color: #4CAF50; color: white; }
.animated.delay-1dot5s {animation-delay: 1.5s;}
.md-icon--search { display:inline-block!important}
a.headerlink{ display: none !important; }
small.edited { display: block; text-align: right; }
#cookie-bar { padding: 1.8rem 1.25rem !important; background: #191A1D  !important; box-shadow:rgba(0, 0, 0, 0.2) 4px 4px 8px 8px; }
#cookie-bar-prompt-logo{ display: none !important; }
div.my-img{text-align:center;margin-top:20px}
@media (max-width: 76.1875em){ .mini{ display: block; } .maxi{ display: none;} /*.md-nav__link[for="nav-1"] { display: none; }*/ }
@media (min-width: 1599.9px){ .md-header-nav__button.md-logo img { height: 37.5px !important; width: 220px; } }
@media (min-width: 1999.9px){ .md-header-nav__button.md-logo img { height: 40px !important; width: 240px; } }
/* Rectificación footer en paginas pequeñas de altura */
@media (max-width: 1599.8px){ .md-container {height: calc(100% - 48px)} }
@media (min-width: 1599.9px){ .md-container {height: calc(100% - 53px)} }
@media (min-width: 1999.9px){ .md-container {height: calc(100% - 58px)} }
@media only screen and (max-width: 959.9px) { .nav__logo { display: block !important; }} 
@media only screen and (min-width: 960px) and (max-width: 76.1875em) { .nav__logo { display: block !important; }} 
@media only screen and (min-width: 76.1875em) { .nav__logo { display: none !important; } } 
@media only screen and (max-width: 76.1875em) { .md-sidebar--primary { left: -26.2rem;; width: 26.2rem; }  [data-md-toggle="drawer"]:checked ~ .md-container .md-sidebar--primary { -webkit-transform: translateX(26.2rem); transform: translateX(26.2rem); } [dir="rtl"] [data-md-toggle="drawer"]:checked ~ .md-container .md-sidebar--primary { -webkit-transform: translateX(-26.2rem); transform: translateX(-26.2rem); } }
@media (min-width: 1219.9px){ #home__btn { display: none !important; } #cursos__btn{ color: white !important; } [data-md-color-primary="grey"] .md-nav__link--active{ color: rgba(0, 0, 0, 0.87); text-decoration: underline !important; } }
@media (min-width: 467.9px){ #discord__btn{ display: inline-block !important; } }
@media only screen and (min-width: 60em){ .md-search__input { background-color: rgb(53, 54, 56); } .md-search__input:hover { background-color: rgb(84, 87, 93); color: white; }}
@media (max-width: 1219.9px){ .md-header-nav__title{ padding: 0 1rem; } .nav__btn {display:none;} }
@media (max-width: 875.9px){ #cookie-bar-button{ margin-top: 20px !important; }}
@media (max-width: 719.9px){ #cookie-bar { padding: 3.25rem 1.25rem; }}
@media (max-width: 512.9px){ #cookie-bar { padding: 2rem 1.25rem; }}

.tingle-modal { font-size:18px !important;}
.tingle-modal-box{ width: 80%; max-width: 1100px; }
.tingle-btn--danger{ background: darkorange !important; }
.tingle-modal-box__content { padding: 3rem 2rem 3rem 3rem;}
@media (max-width: 540px){ .tingle-modal-box{ width: auto; } }
@media (max-width: 849px){ #supermodal{ grid-template-columns:100% !important; }}

.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 275px - 60px)}
@media (max-width: 1999.9px){.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 246px - 60px);margin-right:-1px;}}
@media (max-width: 1599.9px){.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 222px - 60px)}}

</style>
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-979159326"></script>
  <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'AW-979159326');</script>
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="grey" data-md-color-accent="grey">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#proyecto-gestor-de-clientes-en-python" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header
  class="md-header"
  data-md-component="header"
  style="position: inherit !important"
>
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a
          href="/"
          title="Hektor Profe"
          class="md-header-nav__button md-logo"
          style="font-size: 0px"
        >
          <img
            src="/assets/images/logo.png"
            width="200px"
            height="35px"
            style="margin-top: -5px"
            alt="Hektor Profe"
            title="Hektor Profe"
          />
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label
          class="md-icon md-icon--menu md-header-nav__button"
          for="__drawer"
        ></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div
          class="md-flex__ellipsis md-header-nav__title"
          data-md-component="title"
          style="text-align: right"
        >
          <!-- https://fontawesome.com/v4.7.0/ -->
          <a 
            class="nav__btn" 
            href="https://www.hektorprofe.net/" 
            style="margin-left:0em;" 
            title="Cursos de Hektor Profe">
            Cursos
          </a>
          <a 
            class="nav__btn" 
            href="https://docs.hektorprofe.net/" 
            style="margin-left:1.4em;" 
            title="Documentos de Hektor Profe">
            Documentos
          </a>
          <a 
            class="nav__btn" 
            href="https://www.hektorprofe.net/portafolio/" 
            style="margin-left:1.4em;" 
            title="Portafolio de Hektor Profe">
            Portafolio
          </a>
          <a href="/"
            ><img
              class="nav__logo"
              src="/assets/images/logo.png"
              width="200px"
              height="35px"
              style="margin: 6px auto 0"
              alt="Hektor Profe"
              title="Hektor Profe"
          /></a>
        </div>
        <style>
          .md-sidebar[data-md-state="lock"] {
            top: 0rem !important;
          }
          .md-tabs {
            display: none !important;
          }
          .hde {
            display: inline-block;
          }
          .admonition.note > .superfences-tabs > label:hover,
          .headerlink {
            color: #018dc5 !important;
          }
          .admonition.info {
            font-size: 100%;
          }
          .admonition.info label {
            font-size: 91%;
          }
          .admonition.note > .admonition-title {
            display: none;
          }
          .image {
            text-align: center;
            margin-top: 25px;
          }
          .contenedor_youtube {
            position: relative !important;
            padding-bottom: 56.25% !important; /*panorámico*/
            padding-top: 0px !important;
            height: 0 !important;
            margin-top: -20px;
            margin-bottom: 25px;
          }
          .contenedor_youtube iframe {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
          }
        </style>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container" style="padding-top: 0px !important;">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list" id="top__tabs">
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
      </ul>
    </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container" style="padding-top: 8px !important;">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap" id="md__sidebar__scroll">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title" for="__drawer" style="padding:0 !important;max-height:5.5rem;"></label>
  
  <ul class="md-nav__list" id="main__list" data-md-scrollfix>
    
      
    
        <!-- comprobación extra -->
         
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Academia de programación
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Academia de programación
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
            
            
            


  <li class="md-nav__item">
    <a href="../../" title="Índice del archivo" class="md-nav__link">
      Índice del archivo
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../introduccion/" title="Python para principiantes" class="md-nav__link">
      Python para principiantes
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../poo-para-interfaces-graficas/" title="Python para interfaces gráficas" class="md-nav__link">
      Python para interfaces gráficas
    </a>
  </li>

        
            
            
            

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Gestor de clientes con Python
      </label>
    
    <a href="./" title="Gestor de clientes con Python" class="md-nav__link md-nav__link--active" id="md__active_link">
      Gestor de clientes con Python
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requisitos" title="Requisitos" class="md-nav__link toc__link">
    Requisitos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#organizacion" title="Organización" class="md-nav__link toc__link">
    Organización
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mock-database" title="Mock database" class="md-nav__link toc__link">
    Mock database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pruebas-unitarias" title="Pruebas unitarias" class="md-nav__link toc__link">
    Pruebas unitarias
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estructurando-el-menu" title="Estructurando el menú" class="md-nav__link toc__link">
    Estructurando el menú
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#funciones-auxiliares" title="Funciones auxiliares" class="md-nav__link toc__link">
    Funciones auxiliares
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementando-el-menu" title="Implementando el menú" class="md-nav__link toc__link">
    Implementando el menú
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validacion-del-campo-dni" title="Validación del campo DNI" class="md-nav__link toc__link">
    Validación del campo DNI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#persistencia-en-fichero-csv" title="Persistencia en fichero CSV" class="md-nav__link toc__link">
    Persistencia en fichero CSV
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arreglando-las-pruebas-unitarias" title="Arreglando las pruebas unitarias" class="md-nav__link toc__link">
    Arreglando las pruebas unitarias
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-1-ventana-principal" title="GUI (1): Ventana principal" class="md-nav__link toc__link">
    GUI (1): Ventana principal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-2-mixin-para-centrar-widgets" title="GUI (2): Mixin para centrar widgets" class="md-nav__link toc__link">
    GUI (2): Mixin para centrar widgets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-3-widget-treeview" title="GUI (3): Widget Treeview" class="md-nav__link toc__link">
    GUI (3): Widget Treeview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-4-dialogo-de-borrado" title="GUI (4): Diálogo de borrado" class="md-nav__link toc__link">
    GUI (4): Diálogo de borrado
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-5-subventana-de-creacion" title="GUI (5): Subventana de creación" class="md-nav__link toc__link">
    GUI (5): Subventana de creación
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-6-validacion-en-tiempo-real" title="GUI (6): Validación en tiempo real" class="md-nav__link toc__link">
    GUI (6): Validación en tiempo real
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-7-manejando-el-boton-crear" title="GUI (7): Manejando el botón crear" class="md-nav__link toc__link">
    GUI (7): Manejando el botón crear
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-8-subventana-de-modificacion" title="GUI (8): Subventana de modificación" class="md-nav__link toc__link">
    GUI (8): Subventana de modificación
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-9-sincronizacion-de-datos" title="GUI (9): Sincronización de datos" class="md-nav__link toc__link">
    GUI (9): Sincronización de datos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-10-modo-terminal-e-interfaz" title="GUI (10): Modo terminal e interfaz" class="md-nav__link toc__link">
    GUI (10): Modo terminal e interfaz
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../tutoriales/" title="Más tutoriales sobre Python" class="md-nav__link">
      Más tutoriales sobre Python
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../modulo-analitico-numpy/" title="Módulo analítico NumPy" class="md-nav__link">
      Módulo analítico NumPy
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../modulo-grafico-matplotlib/" title="Módulo gráfico Matplotlib" class="md-nav__link">
      Módulo gráfico Matplotlib
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../django/introduccion/" title="Django para principiantes" class="md-nav__link">
      Django para principiantes
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../django/api-rest-framework/" title="Server API pelis en Django Rest" class="md-nav__link">
      Server API pelis en Django Rest
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../django/tutoriales/" title="Más tutoriales sobre Django" class="md-nav__link">
      Más tutoriales sobre Django
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../javascript/introduccion/" title="JavaScript para principiantes" class="md-nav__link">
      JavaScript para principiantes
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../javascript/conversor-divisas/" title="Conversor de divisas en JS" class="md-nav__link">
      Conversor de divisas en JS
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../javascript/biblioteca-p5js/" title="Introducción a P5.js" class="md-nav__link">
      Introducción a P5.js
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../javascript/nodejs/" title="Introducción a Node.js" class="md-nav__link">
      Introducción a Node.js
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../javascript/chat-heroku/" title="Chat online con Node.js" class="md-nav__link">
      Chat online con Node.js
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../javascript/cliente-nuxt/" title="Cliente API pelis en Nuxt.js" class="md-nav__link">
      Cliente API pelis en Nuxt.js
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../gnu-linux/ubuntu-server-web/" title="Configurar Ubuntu Server" class="md-nav__link">
      Configurar Ubuntu Server
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  </ul>
</nav>

                  </div>
                </div>
              </div>
            

            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                
                  
                    <div class="course-offer" style="margin-bottom:25px;padding:0px 10px;">
                      <a href="https://www.hektorprofe.net/cupon/python" target="_blank">
                        <img src="/cdn/assets/python.png" style="width:100%;justify-self:center;align-self:center;"/>
                      </a>
                    </div>
                  
                

                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requisitos" title="Requisitos" class="md-nav__link toc__link">
    Requisitos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#organizacion" title="Organización" class="md-nav__link toc__link">
    Organización
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mock-database" title="Mock database" class="md-nav__link toc__link">
    Mock database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pruebas-unitarias" title="Pruebas unitarias" class="md-nav__link toc__link">
    Pruebas unitarias
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estructurando-el-menu" title="Estructurando el menú" class="md-nav__link toc__link">
    Estructurando el menú
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#funciones-auxiliares" title="Funciones auxiliares" class="md-nav__link toc__link">
    Funciones auxiliares
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementando-el-menu" title="Implementando el menú" class="md-nav__link toc__link">
    Implementando el menú
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validacion-del-campo-dni" title="Validación del campo DNI" class="md-nav__link toc__link">
    Validación del campo DNI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#persistencia-en-fichero-csv" title="Persistencia en fichero CSV" class="md-nav__link toc__link">
    Persistencia en fichero CSV
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arreglando-las-pruebas-unitarias" title="Arreglando las pruebas unitarias" class="md-nav__link toc__link">
    Arreglando las pruebas unitarias
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-1-ventana-principal" title="GUI (1): Ventana principal" class="md-nav__link toc__link">
    GUI (1): Ventana principal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-2-mixin-para-centrar-widgets" title="GUI (2): Mixin para centrar widgets" class="md-nav__link toc__link">
    GUI (2): Mixin para centrar widgets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-3-widget-treeview" title="GUI (3): Widget Treeview" class="md-nav__link toc__link">
    GUI (3): Widget Treeview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-4-dialogo-de-borrado" title="GUI (4): Diálogo de borrado" class="md-nav__link toc__link">
    GUI (4): Diálogo de borrado
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-5-subventana-de-creacion" title="GUI (5): Subventana de creación" class="md-nav__link toc__link">
    GUI (5): Subventana de creación
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-6-validacion-en-tiempo-real" title="GUI (6): Validación en tiempo real" class="md-nav__link toc__link">
    GUI (6): Validación en tiempo real
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-7-manejando-el-boton-crear" title="GUI (7): Manejando el botón crear" class="md-nav__link toc__link">
    GUI (7): Manejando el botón crear
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-8-subventana-de-modificacion" title="GUI (8): Subventana de modificación" class="md-nav__link toc__link">
    GUI (8): Subventana de modificación
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-9-sincronizacion-de-datos" title="GUI (9): Sincronización de datos" class="md-nav__link toc__link">
    GUI (9): Sincronización de datos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gui-10-modo-terminal-e-interfaz" title="GUI (10): Modo terminal e interfaz" class="md-nav__link toc__link">
    GUI (10): Modo terminal e interfaz
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="proyecto-gestor-de-clientes-en-python">Proyecto gestor de clientes en Python<a class="headerlink" href="#proyecto-gestor-de-clientes-en-python" title="Permanent link">&para;</a></h1>
<div class="contenedor_youtube">
  <iframe id="odysee-iframe" width="560" height="315" src="https://odysee.com/$/embed/@hektor:3/-Curso-Gestor-de-clientes:5?r=3icueB68NV3UEFHyqs2QRfzRUeABmHDU" allowfullscreen></iframe>
</div>

<h2 id="requisitos">Requisitos<a class="headerlink" href="#requisitos" title="Permanent link">&para;</a></h2>
<p>Vamos a crear un programa poniendo a prueba lo que sabemos de Python:</p>
<ul>
<li>Listar los clientes del gestor.</li>
<li>Consultar un cliente a partir del <strong>dni</strong>.</li>
<li>Agregar un cliente con campos <strong>nombre</strong>, <strong>apellido</strong>, <strong>dni</strong>.</li>
<li>Modificar el nombre y apellido de un cliente a partir del <strong>dni</strong>.</li>
<li>Borrar un cliente a partir del <strong>dni</strong>.</li>
<li>Salir del programa.</li>
</ul>
<p>No deberá guardar los datos en el disco duro, siempre partirá de unos clientes de prueba iniciales y no podrá haber dos clientes con el mismo <strong>dni</strong>.</p>
<p><strong>Repositorio</strong>: <a href="https://github.com/hektorprofe/curso-gestor-clientes-python" target="_blank">https://github.com/hektorprofe/curso-gestor-clientes-python</a></p>
<h2 id="organizacion">Organización<a class="headerlink" href="#organizacion" title="Permanent link">&para;</a></h2>
<p>Empezaremos creando una carpeta <strong>Gestor de clientes</strong> con un fichero <strong>requirements.txt</strong> y otro <strong>README.md</strong> ambos vacíos, además de una carpeta llamada <strong>gestor/</strong> para contener los scripts de nuestro proyecto.</p>
<p>Esta organización es una buena práctica para ahorrar problemas en el futuro ya que permite añadir todo lo que necesitemos en la raíz externa sin molestar al código fuente, como por ejemplo documentación, pruebas, configuraciones, etc. Es la clave para mentener un proyecto organizado y extensible.</p>
<p>El programa lo vamos a desarrollar en 4 ficheros básicos:</p>
<ul>
<li><code>run.py</code>: El script principal que lo pondrá todo en marcha.</li>
<li><code>menu.py</code>: La interfaz que mostrará por la terminal un menú.</li>
<li><code>database.py</code>: Encargado de manejar la gestión de los datos.</li>
<li><code>helpers.py</code>: Contendrá funciones auxiliares de uso general.</li>
</ul>
<p>A medida que los necesitemos iremos añadiendo otros ficheros.</p>
<h2 id="mock-database">Mock database<a class="headerlink" href="#mock-database" title="Permanent link">&para;</a></h2>
<p>Empecemos con la base de datos del backend, que por ahora contendrá mock objects (objetos para pruebas), más adelante los refactorizaremos cambiándolos por persistencia en un fichero.</p>
<p>Primero la clase <code>Cliente</code>para manejar un cliente:</p>
<p><code>gestor/database.py</code></p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Cliente</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dni</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dni</span> <span class="o">=</span> <span class="n">dni</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nombre</span> <span class="o">=</span> <span class="n">nombre</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apellido</span> <span class="o">=</span> <span class="n">apellido</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dni</span><span class="si">}</span><span class="s2">) </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nombre</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">apellido</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<p>Y una clase <code>Clientes</code> para utilizar como fuente de datos y que implementará las funcionalidades de buscar, crear, actualizar y borrar clientes. Es una clase especial con funciones estáticas, eso significa que no se utilizará para crear instancias, sino que la usaremos directamente como origen único de la información:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Clientes</span><span class="p">:</span>

    <span class="c1"># Lista de clientes</span>
    <span class="n">lista</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">buscar</span><span class="p">(</span><span class="n">dni</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">cliente</span> <span class="ow">in</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cliente</span><span class="o">.</span><span class="n">dni</span> <span class="o">==</span> <span class="n">dni</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cliente</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">crear</span><span class="p">(</span><span class="n">dni</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">):</span>
        <span class="n">cliente</span> <span class="o">=</span> <span class="n">Cliente</span><span class="p">(</span><span class="n">dni</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">)</span>
        <span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cliente</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cliente</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">modificar</span><span class="p">(</span><span class="n">dni</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cliente</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">cliente</span><span class="o">.</span><span class="n">dni</span> <span class="o">==</span> <span class="n">dni</span><span class="p">:</span>
                <span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">nombre</span> <span class="o">=</span> <span class="n">nombre</span>
                <span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">apellido</span> <span class="o">=</span> <span class="n">apellido</span>
                <span class="k">return</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">borrar</span><span class="p">(</span><span class="n">dni</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cliente</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">cliente</span><span class="o">.</span><span class="n">dni</span> <span class="o">==</span> <span class="n">dni</span><span class="p">:</span>
                <span class="n">cliente</span> <span class="o">=</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">cliente</span>
</code></pre></div>
<p>¿Cómo probamos si todo funciona? Pues con unas pruebas unitarias, lo hacemos en la siguiente lección.</p>
<h2 id="pruebas-unitarias">Pruebas unitarias<a class="headerlink" href="#pruebas-unitarias" title="Permanent link">&para;</a></h2>
<p>Para añadir las pruebas crearemos un directorio <code>tests</code>, en plural, con un <code>__init__.py</code> para indicar que es un paquete, así Python podrá autodescubrir los ficheros de pruebas.</p>
<p>Nosotos crearemos uno llamado <code>test_database.py</code> con las siguientes pruebas unitarias:</p>
<p><code>gestor/tests/test_database.py</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">database</span> <span class="k">as</span> <span class="nn">db</span>


<span class="k">class</span> <span class="nc">TestDatabase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Se ejecuta antes de cada prueba</span>
        <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">db</span><span class="o">.</span><span class="n">Cliente</span><span class="p">(</span><span class="s1">&#39;15J&#39;</span><span class="p">,</span> <span class="s1">&#39;Marta&#39;</span><span class="p">,</span> <span class="s1">&#39;Pérez&#39;</span><span class="p">),</span>
            <span class="n">db</span><span class="o">.</span><span class="n">Cliente</span><span class="p">(</span><span class="s1">&#39;48H&#39;</span><span class="p">,</span> <span class="s1">&#39;Manolo&#39;</span><span class="p">,</span> <span class="s1">&#39;López&#39;</span><span class="p">),</span>
            <span class="n">db</span><span class="o">.</span><span class="n">Cliente</span><span class="p">(</span><span class="s1">&#39;28Z&#39;</span><span class="p">,</span> <span class="s1">&#39;Ana&#39;</span><span class="p">,</span> <span class="s1">&#39;García&#39;</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">test_buscar_cliente</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cliente_existente</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">buscar</span><span class="p">(</span><span class="s1">&#39;15J&#39;</span><span class="p">)</span>
        <span class="n">cliente_no_existente</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">buscar</span><span class="p">(</span><span class="s1">&#39;99X&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNotNone</span><span class="p">(</span><span class="n">cliente_existente</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">cliente_no_existente</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_crear_cliente</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">nuevo_cliente</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">crear</span><span class="p">(</span><span class="s1">&#39;39X&#39;</span><span class="p">,</span> <span class="s1">&#39;Héctor&#39;</span><span class="p">,</span> <span class="s1">&#39;Costa&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">nuevo_cliente</span><span class="o">.</span><span class="n">dni</span><span class="p">,</span> <span class="s1">&#39;39X&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">nuevo_cliente</span><span class="o">.</span><span class="n">nombre</span><span class="p">,</span> <span class="s1">&#39;Héctor&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">nuevo_cliente</span><span class="o">.</span><span class="n">apellido</span><span class="p">,</span> <span class="s1">&#39;Costa&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_modificar_cliente</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cliente_a_modificar</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">buscar</span><span class="p">(</span><span class="s1">&#39;28Z&#39;</span><span class="p">))</span>
        <span class="n">cliente_modificado</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">modificar</span><span class="p">(</span><span class="s1">&#39;28Z&#39;</span><span class="p">,</span> <span class="s1">&#39;Mariana&#39;</span><span class="p">,</span> <span class="s1">&#39;Pérez&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">cliente_a_modificar</span><span class="o">.</span><span class="n">nombre</span><span class="p">,</span> <span class="s1">&#39;Ana&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">cliente_modificado</span><span class="o">.</span><span class="n">nombre</span><span class="p">,</span> <span class="s1">&#39;Mariana&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_borrar_cliente</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cliente_borrado</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">borrar</span><span class="p">(</span><span class="s1">&#39;48H&#39;</span><span class="p">)</span>
        <span class="n">cliente_rebuscado</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">buscar</span><span class="p">(</span><span class="s1">&#39;48H&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">cliente_borrado</span><span class="p">,</span> <span class="n">cliente_rebuscado</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</code></pre></div>
<p>Para probar las pruebas necesitamos instalar el paquete <code>pytest</code>:</p>
<div class="highlight"><pre><span></span><code>pip install pytests
</code></pre></div>
<p>Ahora dejamos que <code>pytest</code> autodescubra las pruebas y las ejecute haciendo:</p>
<div class="highlight"><pre><span></span><code>pytest -v
</code></pre></div>
<p>Perfecto, esto nos dará la seguridad de que el módulo <code>database</code> está funcionando.</p>
<h2 id="estructurando-el-menu">Estructurando el menú<a class="headerlink" href="#estructurando-el-menu" title="Permanent link">&para;</a></h2>
<p>Vamos a construir el menú, en lugar de añadirlo en el <code>run.py</code> vamos a hacerlo en su propio módulo. Recordad, cuanto más separado y organizado esté el código más reutilizable y extensible será el programa:</p>
<p><code>gestor/menu.py</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">iniciar</span><span class="p">():</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;clear&#39;</span><span class="p">)</span> <span class="c1"># cls en Windows</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;========================&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  BIENVENIDO AL Manager &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;========================&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[1] Listar clientes     &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[2] Buscar cliente      &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[3] Añadir cliente      &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[4] Modificar cliente   &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[5] Borrar cliente      &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[6] Cerrar el Manager   &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;========================&quot;</span><span class="p">)</span>

        <span class="n">opcion</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;&gt; &quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;clear&#39;</span><span class="p">)</span> <span class="c1"># cls en Windows</span>

        <span class="k">if</span> <span class="n">opcion</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Listando los clientes...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">opcion</span> <span class="o">==</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Buscando un cliente...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">opcion</span> <span class="o">==</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Añadiendo un cliente...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">opcion</span> <span class="o">==</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Modificando un cliente...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">opcion</span> <span class="o">==</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Borrando un cliente...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">opcion</span> <span class="o">==</span> <span class="s1">&#39;6&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saliendo...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Presiona ENTER para continuar...&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Para probarlo podemos añadirlo al fichero <code>run.py</code> impórtándolo cómodamente:</p>
<p><code>gestor/run.py</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">menu</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">menu</span><span class="o">.</span><span class="n">iniciar</span><span class="p">()</span>
</code></pre></div>
<h2 id="funciones-auxiliares">Funciones auxiliares<a class="headerlink" href="#funciones-auxiliares" title="Permanent link">&para;</a></h2>
<p>Es un buen momento para crear unas funciones de ayuda.</p>
<p>La primera será una versión mejorada para limpiar la terminal porque la que tenemos no detecta automáticamente el sistema operativo y uno de los puntos fuertes de Python es que es multiplataforma:</p>
<p><code>gestor/helpers.py</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">platform</span>


<span class="k">def</span> <span class="nf">limpiar_pantalla</span><span class="p">():</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;cls&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span> <span class="k">else</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;clear&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Ahora podemos cargar el módulo cómodamente y ejecutar la función en el menú en lugar de llamar directamente al módulo <strong>os</strong>:</p>
<p><code>gestor/menu.py</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">helpers</span>

<span class="n">helpers</span><span class="o">.</span><span class="n">limpiar_pantalla</span><span class="p">()</span>
</code></pre></div>
<p>La segunda función de ayuda será para leer un texto cómodamente:</p>
<p><code>gestor/helpers.py</code></p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">leer_texto</span><span class="p">(</span><span class="n">longitud_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">longitud_max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">mensaje</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mensaje</span><span class="p">)</span> <span class="k">if</span> <span class="n">mensaje</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">texto</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;&gt; &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">texto</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">longitud_min</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">texto</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">longitud_max</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">texto</span>
</code></pre></div>
<p>Esta función la utilizaremos para leer los campos dni, nombre y apellido del cliente que vayamos a gestionar.</p>
<h2 id="implementando-el-menu">Implementando el menú<a class="headerlink" href="#implementando-el-menu" title="Permanent link">&para;</a></h2>
<p>Por fin ha llegado el momento de conectar la base de datos y el menú, tendremos que envolver las funcionalidades de nuestra <code>database</code> en las diferentes opciones del menú:</p>
<p><code>gestor/menu.py</code></p>
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="n">opcion</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Listando los clientes...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cliente</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cliente</span><span class="p">)</span>

<span class="k">if</span> <span class="n">opcion</span> <span class="o">==</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Buscando un cliente...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">dni</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">leer_texto</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;DNI (2 ints y 1 char)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">cliente</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">buscar</span><span class="p">(</span><span class="n">dni</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cliente</span><span class="p">)</span> <span class="k">if</span> <span class="n">cliente</span> <span class="k">else</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cliente no encontrado.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">opcion</span> <span class="o">==</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Añadiendo un cliente...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">dni</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">leer_texto</span><span class="p">(</span>
        <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;DNI (2 ints y 1 char)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">nombre</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">leer_texto</span><span class="p">(</span>
        <span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;Nombre (de 2 a 30 chars)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
    <span class="n">apellido</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">leer_texto</span><span class="p">(</span>
        <span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;Apellido (de 2 a 30 chars)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
    <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">crear</span><span class="p">(</span><span class="n">dni</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cliente añadido correctamente.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">opcion</span> <span class="o">==</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Modificando un cliente...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">dni</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">leer_texto</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;DNI (2 ints y 1 char)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">cliente</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">buscar</span><span class="p">(</span><span class="n">dni</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cliente</span><span class="p">:</span>
        <span class="n">nombre</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">leer_texto</span><span class="p">(</span>
            <span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Nombre (de 2 a 30 chars) [</span><span class="si">{</span><span class="n">cliente</span><span class="o">.</span><span class="n">nombre</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
        <span class="n">apellido</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">leer_texto</span><span class="p">(</span>
            <span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Apellido (de 2 a 30 chars) [</span><span class="si">{</span><span class="n">cliente</span><span class="o">.</span><span class="n">apellido</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
        <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">modificar</span><span class="p">(</span><span class="n">cliente</span><span class="o">.</span><span class="n">dni</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cliente modificado correctamente.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cliente no encontrado.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">opcion</span> <span class="o">==</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Borrando un cliente...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">dni</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">leer_texto</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;DNI (2 ints y 1 char)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cliente borrado correctamente.&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">borrar</span><span class="p">(</span>
        <span class="n">dni</span><span class="p">)</span> <span class="k">else</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cliente no encontrado.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">opcion</span> <span class="o">==</span> <span class="s1">&#39;6&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saliendo...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">break</span>

<span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Presiona ENTER para continuar...&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="validacion-del-campo-dni">Validación del campo DNI<a class="headerlink" href="#validacion-del-campo-dni" title="Permanent link">&para;</a></h2>
<p>Hay dos cosas que tenemos comprobar para el campo DNI antes de añadir un nuevo cliente. La primera es que el DNI sea válido, es decir, cumpla un formato de dos números y una letra. La segunda es que no haya ningún otro cliente con ese DNI, así que pongámonos a ello.</p>
<p>Vamos a crear la función auxiliar en <code>helpers.py</code>:</p>
<p><code>gestor/helpers.py</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">dni_valido</span><span class="p">(</span><span class="n">dni</span><span class="p">,</span> <span class="n">lista</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;[0-9]</span><span class="si">{2}</span><span class="s1">[A-Z]$&#39;</span><span class="p">,</span> <span class="n">dni</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DNI incorrecto, debe cumplir el formato.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">cliente</span> <span class="ow">in</span> <span class="n">lista</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cliente</span><span class="o">.</span><span class="n">dni</span> <span class="o">==</span> <span class="n">dni</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DNI utilizado por otro cliente.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>
<p>Vamos a añadir una prueba para nuestra nueva función:</p>
<p><code>gestor/tests/test_database.py</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">helpers</span>

<span class="k">def</span> <span class="nf">test_dni_valido</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">dni_valido</span><span class="p">(</span><span class="s1">&#39;00A&#39;</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">dni_valido</span><span class="p">(</span><span class="s1">&#39;23223S&#39;</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">dni_valido</span><span class="p">(</span><span class="s1">&#39;F35&#39;</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">dni_valido</span><span class="p">(</span><span class="s1">&#39;48H&#39;</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">))</span>
</code></pre></div>
<p>Las probamos para ver si todo es correcto:</p>
<div class="highlight"><pre><span></span><code>pytest -v
</code></pre></div>
<p>Con la seguridad de que todo está bien la utilizaremos en un bucle para leer el <code>dni</code> hasta que sea válido:</p>
<p><code>gestor/menu.py</code></p>
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="n">opcion</span> <span class="o">==</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Añadiendo un cliente...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Comprobación de DNI válido</span>
    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">dni</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">leer_texto</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;DNI (2 ints y 1 char)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">helpers</span><span class="o">.</span><span class="n">dni_valido</span><span class="p">(</span><span class="n">dni</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">):</span>
            <span class="k">break</span>

    <span class="n">nombre</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">leer_texto</span><span class="p">(</span>
        <span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;Nombre (de 2 a 30 chars)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
    <span class="n">apellido</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">leer_texto</span><span class="p">(</span>
        <span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;Apellido (de 2 a 30 chars)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
    <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">crear</span><span class="p">(</span><span class="n">dni</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">)</span>
</code></pre></div>
<h2 id="persistencia-en-fichero-csv">Persistencia en fichero CSV<a class="headerlink" href="#persistencia-en-fichero-csv" title="Permanent link">&para;</a></h2>
<p>En esta lección vamos a implementar el módulo CSV, que ya vimos anteriormente en el curso, para almacenar los clientes del gestor.</p>
<p>Cuando el programa se ponga en marcha, la clase <code>database.Clientes</code> cargará los clientes de un fichero y los irá serializando a medida que se realicen cambios.</p>
<p>Para que todo funcione correctamente, trasladaremos los mock objects al fichero CSV desde el principio:</p>
<p><code>gestor/clientes.csv</code></p>
<div class="highlight"><pre><span></span><code>15J;Marta;Perez
48H;Manolo;Lopez
28Z;Ana;Garcia
</code></pre></div>
<p>Cargaremos los clientes del fichero en la lista de <code>Clientes</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Clientes</span><span class="p">:</span>
    <span class="c1"># Creamos la lista y cargamos los clientes en memoria</span>
    <span class="n">lista</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;clientes.csv&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fichero</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">fichero</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dni</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
            <span class="n">cliente</span> <span class="o">=</span> <span class="n">Cliente</span><span class="p">(</span><span class="n">dni</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">)</span>
            <span class="n">lista</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cliente</span><span class="p">)</span>
</code></pre></div>
<p>Esta parte ya funcionará, ahora debemos implementar el método para guardar los <code>Clientes</code> de vuelta en el fichero después de modificarlos.</p>
<p>Podemos crear el método:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">guardar</span><span class="p">():</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;clientes.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fichero</span><span class="p">:</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fichero</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">((</span><span class="n">c</span><span class="o">.</span><span class="n">dni</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">nombre</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">apellido</span><span class="p">))</span>
</code></pre></div>
<p>Lo llamamos después de <code>crear</code>, <code>modificar</code> o <code>borrar</code> un cliente:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">crear</span><span class="p">(</span><span class="n">dni</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">):</span>
    <span class="n">cliente</span> <span class="o">=</span> <span class="n">Cliente</span><span class="p">(</span><span class="n">dni</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">)</span>
    <span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cliente</span><span class="p">)</span>
    <span class="n">Clientes</span><span class="o">.</span><span class="n">guardar</span><span class="p">()</span> <span class="c1"># new</span>
    <span class="k">return</span> <span class="n">cliente</span>

<span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">modificar</span><span class="p">(</span><span class="n">dni</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cliente</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cliente</span><span class="o">.</span><span class="n">dni</span> <span class="o">==</span> <span class="n">dni</span><span class="p">:</span>
            <span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">nombre</span> <span class="o">=</span> <span class="n">nombre</span>
            <span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">apellido</span> <span class="o">=</span> <span class="n">apellido</span>
            <span class="n">Clientes</span><span class="o">.</span><span class="n">guardar</span><span class="p">()</span> <span class="c1"># new</span>
            <span class="k">return</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">borrar</span><span class="p">(</span><span class="n">dni</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cliente</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cliente</span><span class="o">.</span><span class="n">dni</span> <span class="o">==</span> <span class="n">dni</span><span class="p">:</span>
            <span class="n">cliente</span> <span class="o">=</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">Clientes</span><span class="o">.</span><span class="n">guardar</span><span class="p">()</span> <span class="c1"># new</span>
            <span class="k">return</span> <span class="n">cliente</span>
</code></pre></div>
<p>Listo, el programa ya debería sincronizar automáticamente los cambios realizados en la memoria también en el fichero CSV.</p>
<p>Sin embargo los <code>tests</code> de <code>database.py</code>...</p>
<div class="highlight"><pre><span></span><code>pytest -v
</code></pre></div>
<p>Nos están modificando la información original del fichero y esto no puede ser.</p>
<p>Los arreglamos en la próxima lección.</p>
<h2 id="arreglando-las-pruebas-unitarias">Arreglando las pruebas unitarias<a class="headerlink" href="#arreglando-las-pruebas-unitarias" title="Permanent link">&para;</a></h2>
<p>El problema que tenemos es que las pruebas modifican la base de datos del fichero <code>clientes.csv</code>. Esto es un fallo importante porque perderemos los datos cada vez que ejecutemos las pruebas, tenemos que conseguir manejar dos ficheros CSV independientes, uno para las pruebas y otro para el programa.</p>
<p>Para ello vamos a crear un fichero de configuración con una constante que contendrá la localización del CSV:</p>
<p><code>gestor/config.py</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">DATABASE_PATH</span> <span class="o">=</span> <span class="s1">&#39;clientes.csv&#39;</span>
</code></pre></div>
<p>Simplemente substituiremos la ruta en crudo por esta constante:</p>
<p><code>gestor/database.py</code></p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Clientes</span><span class="p">:</span>
    <span class="n">lista</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">DATABASE_PATH</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fichero</span><span class="p">:</span> <span class="c1"># ...</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">guardar</span><span class="p">():</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">DATABASE_PATH</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fichero</span><span class="p">:</span> <span class="c1"># ...</span>
</code></pre></div>
<p>El truco consistirá en definir una constante diferente si trabajamos con las pruebas y eso podemos saberlo analizando el primer argumento del script:</p>
<p><code>gestor/config.py</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">DATABASE_PATH</span> <span class="o">=</span> <span class="s1">&#39;clientes.csv&#39;</span>

<span class="k">if</span> <span class="s1">&#39;pytest&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">DATABASE_PATH</span> <span class="o">=</span> <span class="s1">&#39;tests/clientes_test.csv&#39;</span>
</code></pre></div>
<p>Con esto las pruebas deberían ir a buscar ese nuevo fichero, que no existirá:</p>
<div class="highlight"><pre><span></span><code>pytest -v
</code></pre></div>
<p>Solo tenemos que crearlo:</p>
<p><code>gestor/tests/clientes_tests.csv</code></p>
<p>Y ya tendremos dos ficheros diferentes.</p>
<p>Para redondearlo podemos añadir una prueba para confirmar que el contenido del fichero cambia al realizar modificaciones y asegurarnos de que la persistencia funciona correctamente:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">csv</span>

<span class="k">def</span> <span class="nf">test_escritura_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">borrar</span><span class="p">(</span><span class="s1">&#39;48H&#39;</span><span class="p">)</span>
    <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">borrar</span><span class="p">(</span><span class="s1">&#39;15J&#39;</span><span class="p">)</span>
    <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">modificar</span><span class="p">(</span><span class="s1">&#39;28Z&#39;</span><span class="p">,</span> <span class="s1">&#39;Mariana&#39;</span><span class="p">,</span> <span class="s1">&#39;Pérez&#39;</span><span class="p">)</span>

    <span class="n">dni</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">DATABASE_PATH</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fichero</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">fichero</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
        <span class="n">dni</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>  <span class="c1"># Primera línea del iterador</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dni</span><span class="p">,</span> <span class="s1">&#39;28Z&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">nombre</span><span class="p">,</span> <span class="s1">&#39;Mariana&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">apellido</span><span class="p">,</span> <span class="s1">&#39;Pérez&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Si etodo está correcto las pruebas deberían pasar:</p>
<div class="highlight"><pre><span></span><code>pytest -v
</code></pre></div>
<h2 id="gui-1-ventana-principal">GUI (1): Ventana principal<a class="headerlink" href="#gui-1-ventana-principal" title="Permanent link">&para;</a></h2>
<p>Durante las próximas lecciones vamos a ver la ventaja de haber programado modularmente el programa.</p>
<p>Al tener bien separado el menú de la base de datos podemos substituir la terminal por una interfaz gráfica sin modificar el código base. De hecho no tenemos ni que prescindir de él, podemos proveerlo como alternativa para un entorno sin gráficos, ya veréis que curioso queda.</p>
<p>Para hacer más sencilla la gestión de la ventana y subventanas del programa, vamos a desarrollarlo utilizando clases y objetos, por lo que partiremos de un programa básico de Tkinter manejado en una clase que a mi me gusta llamar <code>MainWindow</code>:</p>
<p><code>gestor/ui.py</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">Tk</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gestor de clientes&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Hola&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hola</span><span class="p">)</span>
        <span class="n">button</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">hola</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;¡Hola mundo!&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</code></pre></div>
<h2 id="gui-2-mixin-para-centrar-widgets">GUI (2): Mixin para centrar widgets<a class="headerlink" href="#gui-2-mixin-para-centrar-widgets" title="Permanent link">&para;</a></h2>
<p>Antes de continuar vamos a tomarnos un momento para invertir en calidad de vida y es que cuando se abre una ventana de tkinter no se posiciona automáticamente en el centro de la pantalla, por lo menos en MAC OS, que es el sistema que utilizo actualmente.</p>
<p>Os voy a enseñar una forma genial de solucionar este problema mediante el uso de un mixin. Un <strong>mixin</strong> es una clase que contiene una o varias definiciones. Por sí mismos los mixins no tienen utilidad, pero al heredarlos en otra clase conseguiremos su funcionalidad y eso es precisamente lo que vamos a hacer, un mixin para centrar un widget en la pantalla (en nuestro caso la ventana principal):</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CenterWidgetMixin</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
        <span class="n">ws</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span>
        <span class="n">hs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">ws</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">hs</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">h</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Si heredamos de este mixin conseguiremos el método <code>center</code> que podemos utilizar al final del constructor para autocentrar la ventana:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">Tk</span><span class="p">,</span> <span class="n">CenterWidgetMixin</span><span class="p">):</span> <span class="c1"># edited</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gestor de clientes&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">()</span> <span class="c1"># new</span>
</code></pre></div>
<h2 id="gui-3-widget-treeview">GUI (3): Widget Treeview<a class="headerlink" href="#gui-3-widget-treeview" title="Permanent link">&para;</a></h2>
<p>Mixins a parte, vamos a utilizar el método <code>build</code> para construir y configurar todos los widgets de la ventana principal. Si queremos comunicar alguno con otro método queramos comunicar con otros métodos lo haremos en atributos de clase.</p>
<p>Ahora, para mostrar los clientes podemos utilizar algo como una tabla. El widget extendido <code>Treeview</code> del subpaquete <code>ttk</code> sirve para eso así que vamos a utilizarlo:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">ttk</span>

<span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Top Frame</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">frame</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

    <span class="c1"># Treeview</span>
    <span class="n">treeview</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Treeview</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
    <span class="n">treeview</span><span class="p">[</span><span class="s1">&#39;columns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;DNI&#39;</span><span class="p">,</span> <span class="s1">&#39;Nombre&#39;</span><span class="p">,</span> <span class="s1">&#39;Apellido&#39;</span><span class="p">)</span>
    <span class="n">treeview</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

    <span class="c1"># Column format</span>
    <span class="n">treeview</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;#0&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="n">NO</span><span class="p">)</span>
    <span class="n">treeview</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;DNI&quot;</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">CENTER</span><span class="p">)</span>
    <span class="n">treeview</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;Nombre&quot;</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">CENTER</span><span class="p">)</span>
    <span class="n">treeview</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;Apellido&quot;</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">CENTER</span><span class="p">)</span>

    <span class="c1"># Heading format</span>
    <span class="n">treeview</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="s2">&quot;#0&quot;</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">CENTER</span><span class="p">)</span>
    <span class="n">treeview</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="s2">&quot;DNI&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;DNI&quot;</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">CENTER</span><span class="p">)</span>
    <span class="n">treeview</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="s2">&quot;Nombre&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Nombre&quot;</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">CENTER</span><span class="p">)</span>
    <span class="n">treeview</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="s2">&quot;Apellido&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Apellido&quot;</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">CENTER</span><span class="p">)</span>

    <span class="c1"># Pack</span>
    <span class="n">treeview</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</code></pre></div>
<p>Por defecto el <code>Treeview</code> no tiene una barra de scroll, deberíamos crear una manualmente y configurarla por si en algún momento hay tantos registros que falta espacio verticalmente:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Scrollbar</span>
<span class="n">scrollbar</span> <span class="o">=</span> <span class="n">Scrollbar</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>        <span class="c1"># new</span>
<span class="n">scrollbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">RIGHT</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>  <span class="c1"># new</span>

<span class="c1"># Treeview</span>
<span class="n">treeview</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Treeview</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">yscrollcommand</span><span class="o">=</span><span class="n">scrollbar</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>  <span class="c1"># edited</span>
<span class="n">treeview</span><span class="p">[</span><span class="s1">&#39;columns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;DNI&#39;</span><span class="p">,</span> <span class="s1">&#39;Nombre&#39;</span><span class="p">,</span> <span class="s1">&#39;Apellido&#39;</span><span class="p">)</span>
<span class="n">treeview</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</code></pre></div>
<p>Vamos a cargar los datos de la base de datos en el <code>treeview</code> justo antes de empaquetarlo:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">database</span> <span class="k">as</span> <span class="nn">db</span>

<span class="c1"># Fill treeview data</span>
<span class="k">for</span> <span class="n">cliente</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">:</span>
    <span class="n">treeview</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
        <span class="n">parent</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="n">iid</span><span class="o">=</span><span class="n">cliente</span><span class="o">.</span><span class="n">dni</span><span class="p">,</span>
        <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="n">cliente</span><span class="o">.</span><span class="n">dni</span><span class="p">,</span> <span class="n">cliente</span><span class="o">.</span><span class="n">nombre</span><span class="p">,</span> <span class="n">cliente</span><span class="o">.</span><span class="n">apellido</span><span class="p">))</span>

<span class="c1"># Treeview repack with scrollbar</span>
<span class="n">treeview</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</code></pre></div>
<p>Vamos a añadir tres botones en un nuevo frame que nos permitan, crear, modificar y borrar registros:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Bottom Frame</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Buttons</span>
<span class="n">Button</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Crear&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Button</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Modificar&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Button</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Borrar&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<p>Para terminar la interfaz base, necesitamos exportar como atributo de clase el <code>treeview</code> ya que lo necesitaremos para realizar tareas como recuperar la información de la fila seleccionada:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Export treeview to the class</span>
<span class="bp">self</span><span class="o">.</span><span class="n">treeview</span> <span class="o">=</span> <span class="n">treeview</span>
</code></pre></div>
<h2 id="gui-4-dialogo-de-borrado">GUI (4): Diálogo de borrado<a class="headerlink" href="#gui-4-dialogo-de-borrado" title="Permanent link">&para;</a></h2>
<p>Ahora hay que programar los botones de acción, empezaremos por el de <strong>borrar</strong> ya es el más sencillo y lo implementaremos sobre un cuadro de diálogo por defecto:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tkinter.messagebox</span> <span class="kn">import</span> <span class="n">askokcancel</span><span class="p">,</span> <span class="n">WARNING</span>

<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">cliente</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">focus</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">cliente</span><span class="p">:</span>
        <span class="n">campos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">cliente</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">)</span>
        <span class="n">confirmar</span> <span class="o">=</span> <span class="n">askokcancel</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Confirmación&#39;</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;¿Borrar a </span><span class="si">{</span><span class="n">campos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">campos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">?&#39;</span><span class="p">,</span>
            <span class="n">icon</span><span class="o">=</span><span class="n">WARNING</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">confirmar</span><span class="p">:</span>
            <span class="c1"># remove the row</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">cliente</span><span class="p">)</span>
</code></pre></div>
<p>Lo llamamos al presionar el botón:</p>
<div class="highlight"><pre><span></span><code><span class="n">Button</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Borrar&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<h2 id="gui-5-subventana-de-creacion">GUI (5): Subventana de creación<a class="headerlink" href="#gui-5-subventana-de-creacion" title="Permanent link">&para;</a></h2>
<p>En cuanto a las opciones de <code>crear</code> y <code>modificar</code> son más complejas, tendremos que programar nuestras propias ventanas secundarias con sus campos de texto, botones y validaciones.</p>
<p>Este es el diseño de la subventana de creación:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CreateClientWindow</span><span class="p">(</span><span class="n">Toplevel</span><span class="p">,</span> <span class="n">CenterWidgetMixin</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Crear cliente&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
        <span class="c1"># Obligar al usuario a interactuar con la subventana</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transient</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Top frame</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Labels</span>
        <span class="n">Label</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;DNI (2 ints y 1 upper char)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">Label</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Nombre (2 a 30 chars)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">Label</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Apellido (2 a 30 chars)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Entries</span>
        <span class="n">dni</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">dni</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">nombre</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">nombre</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">apellido</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">apellido</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Bottom frame</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Buttons</span>
        <span class="n">crear</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Crear&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_client</span><span class="p">)</span>
        <span class="n">crear</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">DISABLED</span><span class="p">)</span>
        <span class="n">crear</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">Button</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Cancelar&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</code></pre></div>
<p>Crearemos una instancia desde un nuevo método en la ventana principal:</p>
<div class="highlight"><pre><span></span><code><span class="n">Button</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Crear&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_client_window</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">create_client_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">CreateClientWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
<h2 id="gui-6-validacion-en-tiempo-real">GUI (6): Validación en tiempo real<a class="headerlink" href="#gui-6-validacion-en-tiempo-real" title="Permanent link">&para;</a></h2>
<p>La interfaz de la subventana de creación está lista, ahora vamos a configurar las validaciones en los campos antes de recuperar la información y añadir el nuevo cliente a la tabla:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Entries and validations</span>
<span class="n">dni</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="n">dni</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dni</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;KeyRelease&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">ev</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">ev</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">nombre</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="n">nombre</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">nombre</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;KeyRelease&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">ev</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">ev</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">apellido</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="n">apellido</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">apellido</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;KeyRelease&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">ev</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">ev</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</code></pre></div>
<p>Los métodos bindeados con las validaciones quedarán:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="n">valor</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="c1"># Validar como dni si es el primer campo o textual para los otros dos</span>
    <span class="n">valido</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">dni_valido</span><span class="p">(</span><span class="n">valor</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">)</span> <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span> \
        <span class="k">else</span> <span class="p">(</span><span class="n">valor</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">({</span><span class="s2">&quot;bg&quot;</span><span class="p">:</span> <span class="s2">&quot;Green&quot;</span> <span class="k">if</span> <span class="n">valido</span> <span class="k">else</span> <span class="s2">&quot;Red&quot;</span><span class="p">})</span>
</code></pre></div>
<h2 id="gui-7-manejando-el-boton-crear">GUI (7): Manejando el botón crear<a class="headerlink" href="#gui-7-manejando-el-boton-crear" title="Permanent link">&para;</a></h2>
<p>Para controlar las validaciones y activar o desactivar el botón de creación utilizaremos una lista con booleanos que cambiaremos en tiempo real en las validaciones:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create button activation</span>
<span class="bp">self</span><span class="o">.</span><span class="n">validaciones</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># False, False, False</span>

<span class="c1"># Class exports</span>
<span class="bp">self</span><span class="o">.</span><span class="n">crear</span> <span class="o">=</span> <span class="n">crear</span>

<span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="n">valor</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="c1"># Validar el dni si es el primer campo o textual para los otros dos</span>
    <span class="n">valido</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">dni_valido</span><span class="p">(</span><span class="n">valor</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">lista</span><span class="p">)</span> <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span> \
        <span class="k">else</span> <span class="p">(</span><span class="n">valor</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">({</span><span class="s2">&quot;bg&quot;</span><span class="p">:</span> <span class="s2">&quot;Green&quot;</span> <span class="k">if</span> <span class="n">valido</span> <span class="k">else</span> <span class="s2">&quot;Red&quot;</span><span class="p">})</span>
    <span class="c1"># Cambiar estado del botón en base a las validaciones</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validaciones</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">valido</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">crear</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">NORMAL</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validaciones</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="k">else</span> <span class="n">DISABLED</span><span class="p">)</span>
</code></pre></div>
<p>Finalmente para crear el registro en la tabla haremos referencia al <code>treeview</code> de la ventana principal mediante el accesor <code>master</code>, pero antes necesitaremos exportar los campos para poder acceder a los valores entre métodos de la clase:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Class exports</span>
<span class="bp">self</span><span class="o">.</span><span class="n">crear</span> <span class="o">=</span> <span class="n">crear</span>
<span class="bp">self</span><span class="o">.</span><span class="n">dni</span> <span class="o">=</span> <span class="n">dni</span>
<span class="bp">self</span><span class="o">.</span><span class="n">nombre</span> <span class="o">=</span> <span class="n">nombre</span>
<span class="bp">self</span><span class="o">.</span><span class="n">apellido</span> <span class="o">=</span> <span class="n">apellido</span>
</code></pre></div>
<p>Con ellos podemos crear el cliente en el <code>treeview</code> y cerrar la subventana:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
        <span class="n">parent</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="n">iid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dni</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
        <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dni</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">nombre</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">apellido</span><span class="o">.</span><span class="n">get</span><span class="p">()))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
<p>Listo, vamos a por la subventana de modificación.</p>
<h2 id="gui-8-subventana-de-modificacion">GUI (8): Subventana de modificación<a class="headerlink" href="#gui-8-subventana-de-modificacion" title="Permanent link">&para;</a></h2>
<p>Para modificar un cliente vamos a reutilizar en gran parte lo que tenemos en la subventana de creación, la ventaja es que ahora no necesitamos aplicar validación al campo DNI porque éste no es editable, por lo que lo desactivaremos.</p>
<p>La implementación de esta subventana es mayormente una copia recortada de la de creación, con la peculiaridad de que al cargarla buscaremos el cliente seleccionado en la <code>treeview</code> y escribiremos los valores inicialmente en los campos.</p>
<p>Además esta vez dejaremos activado el botón de <code>Actualizar</code> por defecto:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">EditClientWindow</span><span class="p">(</span><span class="n">Toplevel</span><span class="p">,</span> <span class="n">CenterWidgetMixin</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Actualizar cliente&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
        <span class="c1"># Obligar al usuario a interactuar con la subventana</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transient</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Top frame</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Labels</span>
        <span class="n">Label</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;DNI (no editable)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">Label</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Nombre (2 a 30 chars)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">Label</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Apellido (2 a 30 chars)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Entries</span>
        <span class="n">dni</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">dni</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">nombre</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">nombre</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">nombre</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;KeyRelease&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">ev</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">ev</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">apellido</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">apellido</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">apellido</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;KeyRelease&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">ev</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">ev</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="c1"># Set entries initial values</span>
        <span class="n">cliente</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">focus</span><span class="p">()</span>
        <span class="n">campos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">cliente</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">)</span>
        <span class="n">dni</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">campos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">dni</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">DISABLED</span><span class="p">)</span>
        <span class="n">nombre</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">campos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">apellido</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">campos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="c1"># Bottom frame</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Buttons</span>
        <span class="n">actualizar</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Actualizar&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">update_client</span><span class="p">)</span>
        <span class="n">actualizar</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">Button</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Cancelar&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Update button activation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validaciones</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># True, True</span>

        <span class="c1"># Class exports</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actualizar</span> <span class="o">=</span> <span class="n">actualizar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dni</span> <span class="o">=</span> <span class="n">dni</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nombre</span> <span class="o">=</span> <span class="n">nombre</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apellido</span> <span class="o">=</span> <span class="n">apellido</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">valor</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">valido</span> <span class="o">=</span> <span class="p">(</span><span class="n">valor</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">)</span>
        <span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">({</span><span class="s2">&quot;bg&quot;</span><span class="p">:</span> <span class="s2">&quot;Green&quot;</span> <span class="k">if</span> <span class="n">valido</span> <span class="k">else</span> <span class="s2">&quot;Red&quot;</span><span class="p">})</span>
        <span class="c1"># Cambiar estado del botón en base a las validaciones</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validaciones</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">valido</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actualizar</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">NORMAL</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validaciones</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="n">DISABLED</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</code></pre></div>
<p>Actualizar los valores en la función <code>update_client</code> es tan fácil como hacer referencia a la fila activa del <code>treeview</code> y sobreecribir sus campos:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">cliente</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">focus</span><span class="p">()</span>
    <span class="c1"># Sobreescribimos los datos de la fila seleccionada</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">item</span><span class="p">(</span>
        <span class="n">cliente</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dni</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">nombre</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">apellido</span><span class="o">.</span><span class="n">get</span><span class="p">()))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
<p>Perfecto, lo tenemos todo preparado a falta de sincronizar los cambios de la tabla en el fichero.</p>
<h2 id="gui-9-sincronizacion-de-datos">GUI (9): Sincronización de datos<a class="headerlink" href="#gui-9-sincronizacion-de-datos" title="Permanent link">&para;</a></h2>
<p>Para volcar los datos de la tabla al fichero CSV, solo tenemos que enlazar los momentos de creación, actualización y borrado a los métodos de la clase <code>Clientes</code> de nuestro módulo <code>database</code>. Es decir, a parte de modificar los cambios en la <code>treeview</code> visualmente, también haremos lo propio en la clase <code>db.Clientes</code>.</p>
<p>El <strong>borrado</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">cliente</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">focus</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">cliente</span><span class="p">:</span>
        <span class="n">campos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">cliente</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">)</span>
        <span class="n">confirmar</span> <span class="o">=</span> <span class="n">askokcancel</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Confirmación&#39;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;¿Borrar a </span><span class="si">{</span><span class="n">campos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">campos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">?&#39;</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="n">WARNING</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">confirmar</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">cliente</span><span class="p">)</span>
            <span class="c1"># !!! Borrar también en el fichero</span>
            <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">borrar</span><span class="p">(</span><span class="n">campos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div>
<p>La <strong>creación</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
        <span class="n">parent</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="n">iid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dni</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
        <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dni</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">nombre</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">apellido</span><span class="o">.</span><span class="n">get</span><span class="p">()))</span>
    <span class="c1"># !!! Crear también en el fichero</span>
    <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">crear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dni</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">nombre</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">apellido</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
<p>Y la <strong>actualización</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">cliente</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">focus</span><span class="p">()</span>
    <span class="c1"># Sobreescribir los datos</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">item</span><span class="p">(</span>
        <span class="n">cliente</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dni</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">nombre</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">apellido</span><span class="o">.</span><span class="n">get</span><span class="p">()))</span>
    <span class="c1"># !!! Modificar también en el fichero</span>
    <span class="n">db</span><span class="o">.</span><span class="n">Clientes</span><span class="o">.</span><span class="n">modificar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dni</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">nombre</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">apellido</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
<p>Con esto hemos terminado la interfaz pero todavía nos falta un pequeño detalle...</p>
<h2 id="gui-10-modo-terminal-e-interfaz">GUI (10): Modo terminal e interfaz<a class="headerlink" href="#gui-10-modo-terminal-e-interfaz" title="Permanent link">&para;</a></h2>
<p>Cuando empezamos a crear la interfaz os comenté que no era necesario descartar el programa para la terminal, sino que podíamos implementar ambos.</p>
<p>Para lograrlo sería tan fácil como pasar un argumento al ejecutar el script:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">menu</span>
<span class="kn">import</span> <span class="nn">ui</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Si pasamos un argumento -t lanzamos el modo terminal</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-t&quot;</span><span class="p">:</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">iniciar</span><span class="p">()</span>
    <span class="c1"># En cualquier otro caso lanzamos el modo gráfico</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">app</span> <span class="o">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">MainWindow</span><span class="p">()</span>
        <span class="n">app</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</code></pre></div>
<p>Listo, ahora si ejecutamo el script con <code>-t</code> lanzaremos el modo terminal:</p>
<div class="highlight"><pre><span></span><code>python3 run.py -t
</code></pre></div>
<p>Y si lo ejecutamos normalmente, el modo gráfico:</p>
<div class="highlight"><pre><span></span><code>python3 run.py
</code></pre></div>
<p>Con esto acabamos, espero que os haya gustado y hayáis aprendido mucho.</p>
<p>Solo quiero comentar que si os interesa el tema de las interfaces, en <code>hektorprofe.net</code> encontraréis mi curso completo sobre <code>PySide</code> con un montón de proyectos prácticos. Es una biblioteca infinitamente más potente que <code>tkinter</code> y un estándar en la industria por ser el binding oficial de <code>Qt</code>para Python.</p>
<p>Sin más, nos vemos en la próxima sección.</p>
<hr />
<p><small class="edited"><i>Última edición: 12 de Julio de 2022</i></small></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-nav">
    <nav class="md-footer-nav__inner md-grid">
      
      <a
        href="../poo-para-interfaces-graficas/"
        title="Python para interfaces gráficas"
        class="md-flex md-footer-nav__link md-footer-nav__link--prev"
        rel="prev"
      >
        <div class="md-flex__cell md-flex__cell--shrink">
          <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
        </div>
        <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
          <span class="md-flex__ellipsis">
            <span class="md-footer-nav__direction">
              Anterior
            </span>
            Python para interfaces gráficas
          </span>
        </div>
      </a>
       
      <a
        href="../tutoriales/"
        title="Más tutoriales sobre Python"
        class="md-flex md-footer-nav__link md-footer-nav__link--next"
        rel="next"
      >
        <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
          <span class="md-flex__ellipsis">
            <span class="md-footer-nav__direction">
              Siguiente
            </span>
            Más tutoriales sobre Python
          </span>
        </div>
        <div class="md-flex__cell md-flex__cell--shrink">
          <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
        </div>
      </a>
      
    </nav>
  </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        <!--<div class="md-footer-links__highlight">
          <a href="/comunidad/">Comunidad</a> · <a href="/politica-de-cookies/">Política de cookies</a> · <a href="/sobre-mi/">Sobre mí</a>
        </div>-->
        <div class="md-footer-copyright__highlight">
          2015 - 2022 &copy; Héctor Costa Guzmán (<u
            ><a
              href="https://creativecommons.org/licenses/by/4.0/deed.es"
              target="_blank"
              rel="nofollow"
              >Licencia CC BY 4.0</a
            ></u
          >)
        </div>
      </div>
       
<style>.md-footer-social__link {transition: 0.3s;}</style>
<div class="md-footer-social" style="font-size: 2.5rem; margin-top: -6px!important; padding: 0px!important; margin-bottom: -6px; overflow: hidden!important;">
  <a href="https://github.com/hcosta" title="Github" target="_blank" class="md-footer-social__link fa fa-github-square"></a>
  <a href="https://www.youtube.com/c/HektorProfe" title="Youtube" target="_blank" class="md-footer-social__link fa fa-youtube-square"></a>
  &nbsp;
</div>
 
    </div>
  </div>
</footer>
      
      <a id="anchorID" href="https://www.hektorprofe.net/" target="_blank"></a>
    </div>
  <script type='text/javascript' src="/assets/javascripts/application.a26c1c21.js"></script>
  <script src="/assets/javascripts/tingle.min.js"></script>
  <script type='text/javascript'>
    var modalButtonOnly = new tingle.modal({
        closeMethods: [],
        footer: true,
        stickyFooter: true
    });
    var btn5 = document.querySelector('.js-tingle-modal-5');

    // set content
    modalButtonOnly.setContent(`
    <div style="display:grid;grid-template-columns:32% 32% 32%;grid-column-gap: 1.33%;" id="supermodal">
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/python" target="_blank"><img src="/cdn/assets/python.png" style="width:100%;justify-self:center;align-self:center;"/></a>
      </div>
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/django" target="_blank"><img src="/cdn/assets/django.png" style="width:100%;justify-self:center;align-self:center;"/></a>
      </div>
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/pyside" target="_blank"><img src="/cdn/assets/pyside.png" style="width:100%;justify-self:center;align-self:center;"/></a>
      </div>
    </div>`);

    modalButtonOnly.addFooterBtn('Cerrar', 'tingle-btn tingle-btn--default tingle-btn--pull-right', function(){
      modalButtonOnly.close();
    });

    app.initialize({version:"1.2.3",url:{base:"../../.."}})
    var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.LazyLoad=e()}(this,function(){"use strict";function t(t,e,n){var o=e._settings;!n&&i(t)||(C(o.callback_enter,t),R.indexOf(t.tagName)>-1&&(N(t,e),I(t,o.class_loading)),E(t,e),a(t),C(o.callback_set,t))}var e={elements_selector:"img",container:document,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",class_loading:"loading",class_loaded:"loaded",class_error:"error",load_delay:0,callback_load:null,callback_error:null,callback_set:null,callback_enter:null,callback_finish:null,to_webp:!1},n=function(t){return _extends({},e,t)},o=function(t,e){return t.getAttribute("data-"+e)},r=function(t,e,n){var o="data-"+e;null!==n?t.setAttribute(o,n):t.removeAttribute(o)},a=function(t){return r(t,"was-processed","true")},i=function(t){return"true"===o(t,"was-processed")},s=function(t,e){return r(t,"ll-timeout",e)},c=function(t){return o(t,"ll-timeout")},l=function(t){return t.filter(function(t){return!i(t)})},u=function(t,e){return t.filter(function(t){return t!==e})},d=function(t,e){var n,o=new t(e);try{n=new CustomEvent("LazyLoad::Initialized",{detail:{instance:o}})}catch(t){(n=document.createEvent("CustomEvent")).initCustomEvent("LazyLoad::Initialized",!1,!1,{instance:o})}window.dispatchEvent(n)},f=function(t,e){return e?t.replace(/\.(jpe?g|png)/gi,".webp"):t},_="undefined"!=typeof window,v=_&&!("onscroll"in window)||/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),g=_&&"IntersectionObserver"in window,h=_&&"classList"in document.createElement("p"),b=_&&function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}(),m=function(t,e,n,r){for(var a,i=0;a=t.children[i];i+=1)if("SOURCE"===a.tagName){var s=o(a,n);p(a,e,s,r)}},p=function(t,e,n,o){n&&t.setAttribute(e,f(n,o))},y=function(t,e){var n=b&&e.to_webp,r=o(t,e.data_src),a=o(t,e.data_bg);if(r){var i=f(r,n);t.style.backgroundImage='url("'+i+'")'}if(a){var s=f(a,n);t.style.backgroundImage=s}},w={IMG:function(t,e){var n=b&&e.to_webp,r=e.data_srcset,a=t.parentNode;a&&"PICTURE"===a.tagName&&m(a,"srcset",r,n);var i=o(t,e.data_sizes);p(t,"sizes",i);var s=o(t,r);p(t,"srcset",s,n);var c=o(t,e.data_src);p(t,"src",c,n)},IFRAME:function(t,e){var n=o(t,e.data_src);p(t,"src",n)},VIDEO:function(t,e){var n=e.data_src,r=o(t,n);m(t,"src",n),p(t,"src",r),t.load()}},E=function(t,e){var n=e._settings,o=t.tagName,r=w[o];if(r)return r(t,n),e._updateLoadingCount(1),void(e._elements=u(e._elements,t));y(t,n)},I=function(t,e){h?t.classList.add(e):t.className+=(t.className?" ":"")+e},L=function(t,e){h?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")},C=function(t,e){t&&t(e)},O=function(t,e,n){t.addEventListener(e,n)},k=function(t,e,n){t.removeEventListener(e,n)},x=function(t,e,n){O(t,"load",e),O(t,"loadeddata",e),O(t,"error",n)},A=function(t,e,n){k(t,"load",e),k(t,"loadeddata",e),k(t,"error",n)},z=function(t,e,n){var o=n._settings,r=e?o.class_loaded:o.class_error,a=e?o.callback_load:o.callback_error,i=t.target;L(i,o.class_loading),I(i,r),C(a,i),n._updateLoadingCount(-1)},N=function(t,e){var n=function n(r){z(r,!0,e),A(t,n,o)},o=function o(r){z(r,!1,e),A(t,n,o)};x(t,n,o)},R=["IMG","IFRAME","VIDEO"],S=function(e,n,o){t(e,o),n.unobserve(e)},M=function(t){var e=c(t);e&&(clearTimeout(e),s(t,null))},j=function(t,e,n){var o=n._settings.load_delay,r=c(t);r||(r=setTimeout(function(){S(t,e,n),M(t)},o),s(t,r))},D=function(t){return t.isIntersecting||t.intersectionRatio>0},T=function(t){return{root:t.container===document?null:t.container,rootMargin:t.thresholds||t.threshold+"px"}},U=function(t,e){this._settings=n(t),this._setObserver(),this._loadingCount=0,this.update(e)};return U.prototype={_manageIntersection:function(t){var e=this._observer,n=this._settings.load_delay,o=t.target;n?D(t)?j(o,e,this):M(o):D(t)&&S(o,e,this)},_onIntersection:function(t){t.forEach(this._manageIntersection.bind(this))},_setObserver:function(){g&&(this._observer=new IntersectionObserver(this._onIntersection.bind(this),T(this._settings)))},_updateLoadingCount:function(t){this._loadingCount+=t,0===this._elements.length&&0===this._loadingCount&&C(this._settings.callback_finish)},update:function(t){var e=this,n=this._settings,o=t||n.container.querySelectorAll(n.elements_selector);this._elements=l(Array.prototype.slice.call(o)),!v&&this._observer?this._elements.forEach(function(t){e._observer.observe(t)}):this.loadAll()},destroy:function(){var t=this;this._observer&&(this._elements.forEach(function(e){t._observer.unobserve(e)}),this._observer=null),this._elements=null,this._settings=null},load:function(e,n){t(e,this,n)},loadAll:function(){var t=this;this._elements.forEach(function(e){t.load(e)})}},_&&function(t,e){if(e)if(e.length)for(var n,o=0;n=e[o];o+=1)d(t,n);else d(t,e)}(U,window.lazyLoadOptions),U});
    var myLazyLoad = new LazyLoad({elements_selector: ".lazy"});
    const mdMenuItems = document.querySelectorAll('.md-nav__link');
    function doNav(){ document.getElementById("main__list").innerHTML = '<li class="md-nav__item"><a class="md-nav__link" href="/cursos/">Cursos</a></li><li class="md-nav__item"><a class="md-nav__link" href="/blog/">Blog</a></li>';}
    for (i = 0; i < mdMenuItems.length; i++) {  var item = mdMenuItems[i]; var htmlstring = item.innerHTML; htmlstring = (htmlstring.trim) ? htmlstring.trim() : htmlstring.replace(/^\s+/,''); if (htmlstring == 'Servidor de encuentro') { item.parentNode.removeChild(item);continue; }  if (htmlstring == 'Política de Cookies') { item.parentNode.removeChild(item);continue; } if (htmlstring == 'Buscador') { item.parentNode.removeChild(item); continue; } }
    try { var topPos = document.querySelector('#md__active_link').offsetTop; document.querySelector('#md__sidebar__scroll').scrollTop = topPos - 60; } catch (err) {}
  </script>
  </body>
</html>